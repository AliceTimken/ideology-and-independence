---
title: "ideology_independence_data"
author: "Alice Timken"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# -------------- Packages -------------------------------
## First specify the packages of interest
packages <- c("stats", "graphics", "Hmisc", "ggplot2","randomizr", 
              "lmtest", "sandwich", "rmarkdown", "dagitty", "devtools", 
              "knitr", "haven", "estimatr", "rdrobust" , "labelled",
              "expss", "dplyr", "xtable", "poliscidata", "plm",
              "optimx", "margins", "glm2", "naniar", "TSstudio", "gmodels")
## Now load or install&load all
package.check <- lapply(
  packages,
  FUN = function(x) {
    if (!require(x, character.only = TRUE)) {
      install.packages(x, dependencies = TRUE)
      library(x, character.only = TRUE)
    }
  }
)

library(fixest)

```



# DPI2020: Database of Political Institutions

### Load data

```{r load DPI data}
###############################################

DPI <- read.csv("/Users/alice/Desktop/PhD Program/Fall 2024/Spring 2025/Quant Model Submission/Data June 2025/DPI/DPI2020/dpi2020.csv")

# Fix country names
DPI$ifs_fix <- DPI$ifs
DPI$ifs_fix[DPI$ifs == "SUN"] <- "RUS" #Soviet Union
DPI$ifs_fix[DPI$ifs == "TMP"] <- "TLS" #Timor-Leste
DPI$ifs_fix[DPI$ifs == "ZAR"] <- "COD" #Dem. Rep. Congo
DPI$ifs_fix[DPI$ifs == "CSK"] <- "CZE" #Czechia
DPI$ifs_fix[DPI$ifs == "ROM"] <- "ROU" #Romania

# Make blanks = NA
DPI$system_fix <- DPI$system
DPI$system_fix[DPI$system == ""] <- NA

# create country-year identifier (country+year)
DPI$cy1 <- paste(DPI$ifs_fix, DPI$year)
DPI$cy2 <- paste(DPI$countryname, DPI$year)

library(fixest)

# cy with lag
DPI$year_lag <- lag_fml(year ~ countryname + year, k = 1, DPI)
DPI$cy <- paste(DPI$ifs_fix, DPI$year_lag)

# don't lag year for certain countries
no_lag_countries <- c("Ecuador")
DPI$cy[DPI$countryname %in% no_lag_countries] <- DPI$cy1[DPI$countryname %in% no_lag_countries]

# fix -999 NA's for all house
summary(DPI$allhouse)
DPI$allhouse[DPI$allhouse == -999] <- NA
summary(DPI$allhouse)

# fix -999 NA's for percentl
summary(DPI$percentl)
DPI$percentl[DPI$percentl == -999] <- NA
summary(DPI$percentl)

#class(cabinets$election_year)
#summary(cabinets$cabinet_party) # no missing, 31.8% cabinet parties

```

## Democracy indicator

### Boix, Miller, Rosato 2013 - Regimes

```{r boix data}

## Load boix 2013 data 
boix2013 <- read.csv("~/Desktop/Phd Program/Fall 2024/Boix 2013 Dataverse/democracy-v4.0.csv")

# describe data
describe(boix2013$democracy) # 645 missing

# create fix variables
boix2013$country_fix <- boix2013$country
boix2013$abbreviation_fix <- boix2013$abbreviation

library(stringr)

# Fix country case (title case)
boix2013$country_fix <- str_to_title(boix2013$country_fix)

# fix country
boix2013$country_fix[boix2013$country == 'UNITED STATES OF AMERICA'] <- 'United States of America'
boix2013$country_fix[boix2013$country == 'CZECHOSLOVAKIA'] <- 'Czech Republic'
boix2013$country_fix[boix2013$country == 'TURKEY'] <- 'Turkey'



# fix abbreviations
boix2013$abbreviation_fix[boix2013$abbreviation == 'CSK'] <- 'CZE'
boix2013$abbreviation_fix[boix2013$abbreviation == 'SWD'] <- 'SWE'
boix2013$abbreviation_fix[boix2013$abbreviation == 'SVU'] <- 'RUS'
boix2013$abbreviation_fix[boix2013$abbreviation_undp == 'KSV'] <- 'XKX'
boix2013$abbreviation_fix[boix2013$abbreviation == 'ETF'] <- 'ETH'
boix2013$abbreviation_fix[boix2013$abbreviation == 'TMP'] <- 'TLS'
boix2013$abbreviation_fix[boix2013$abbreviation == 'ZAR'] <- 'COD'
boix2013$abbreviation_fix[boix2013$abbreviation_undp == 'MNT'] <- 'MNE'
boix2013$abbreviation_fix[boix2013$abbreviation_undp == 'SRB'] <- 'SRB'
boix2013$abbreviation_fix[boix2013$abbreviation == 'ROM'] <- 'ROU'


# create country-year identifier (country+year)
boix2013$cy <- paste(boix2013$abbreviation_fix, boix2013$year)
boix2013$cy2 <- paste(boix2013$country_fix, boix2013$year)

## Match data
# populate, match by country-year 'cy' variable
#df.cabinets$democracy <- boix2013$democracy[match(df.cabinets$cy, boix2013$cy)] # 

```


# V-party data

### Load V-party data

```{r vparty}
vparty <- read.csv("/Users/alice/Desktop/PhD Program/Summer 2024/EITM/Model/vparty/V_Party.csv")

# explore vparty data
# years
describe(vparty$year) # min 1900, max 2019
describe(vparty$year[vparty$v2xpa_antiplural != 'NA']) # min 1965, max 2019
# antipluralism
summary(vparty$v2xpa_antiplural) # 5593 NAs of 11898 total obs
summary(vparty$year[vparty$v2xpa_antiplural != '']) # earliest year of API is 1965
describe(vparty$v2xpa_antiplural[vparty$year >= 1965]) # after 1965, 1621 NAs of 6305 total obs
unique(vparty$country_text_id)

# create country-year-party identifier (country+year+party)
vparty$id <- paste(vparty$country_text_id, vparty$year, vparty$v2pashname)

# create country-year identifier (country+year)
vparty$cy <- paste(vparty$country_text_id, vparty$year)

# create country-year identifier (country+year)
vparty$cy2 <- paste(vparty$country_name, vparty$year)

# add seatshare for easy reference
vparty$seatshare_vparty <- vparty$v2paseatshare

## Name regional categories - Region (politico-geographic) 
#1: Eastern Europe and post Soviet Union (including Central Asia, Mongolia, and German Democratic Republic)
#2: Latin America (including Cuba, Haiti, and the Dominican Republic)
#3: North Africa and the Middle East (including Israel and Türkiye, but excluding Cyprus)
#4: Sub–Saharan Africa
#5: Western Europe and North America (including Australia, New Zealand, and Cyprus, but excluding German Democratic Republic)
#6: Eastern Asia (including Japan, excluding Mongolia)
#7: South–Eastern Asia
#8: Southern Asia
#9: The Pacific (excluding Australia and New Zealand)
#10: The Caribbean (including Guyana and Suriname, but excluding Cuba, Haiti, and theDominican Republic)

# political region
## Transform political region variable

vparty$region[vparty$e_regionpol == 1] <- 'E. Europe'
vparty$region[vparty$e_regionpol == 2] <- 'Latin Am.'
vparty$region[vparty$e_regionpol == 3] <- 'MENA'
vparty$region[vparty$e_regionpol == 4] <- 'Sub-S. Africa'
vparty$region[vparty$e_regionpol == 5] <- 'W. Europe, N. Am.'
vparty$region[vparty$e_regionpol == 6] <- 'E. Asia'
vparty$region[vparty$e_regionpol == 7] <- 'S.E. Asia'
vparty$region[vparty$e_regionpol == 8] <- 'S. Asia'
vparty$region[vparty$e_regionpol == 9] <- 'Pacific'
vparty$region[vparty$e_regionpol == 10] <- 'Carribean'

```

```{r match democracy boix}

## Match data
# populate, match by country-year 'cy' variable
#vparty$democracy <- boix2013$democracy[match(vparty$cy, boix2013$cy)] # 

## Boix, Miller, Rosato
# Democracy
vparty$boix_democracy <- boix2013$democracy[match(vparty$cy, boix2013$cy)]
summary(vparty$boix_democracy) #n=7281, 918 NA

```

### Explore data

```{r explore party positions}

# Anti-Pluralism vs. Populism
# 3.2.13 Economic left-right scale (C) (v2pariglef)

# plot vparty
ggplot(data = subset(vparty, year >= 1976 & year <= 2014 & boix_democracy == 1 & country_name != "Timor-Leste" & country_name != "Bosnia and Herzegovina"), mapping = aes(x = v2xpa_popul, y = v2xpa_antiplural)) +
  geom_point(alpha = 0.5, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "", x = "Anti-elitism (V-Party)", y = "Anti-pluralism (V-Party)", color = "Region", size = "Seat Share")

# plot vparty
ggplot(data = subset(vparty, year >= 1976 & year <= 2015 & boix_democracy == 1), mapping = aes(x = v2xpa_antiplural, y = v2pariglef)) +
  geom_point(alpha = 0.3, aes(size = v2paseatshare, color = as.factor(e_regionpol))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Anti-pluralism (V-Party)", y = "Economic Left-Right (V-Party)")

# plot vparty
ggplot(data = subset(vparty, year >= 1976 & year <= 2015 & boix_democracy == 1), mapping = aes(x = v2pariglef, y = v2xpa_popul)) +
  geom_point(alpha = 0.3, aes(size = v2paseatshare, color = as.factor(e_regionpol))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Economic Left-Right (V-Party)", y = "Populist Rhetoric (V-Party)")

```

```{r explore vparty data anti-pluralism}

# Liberal–Traditional Scaling
# 4.2.1 Position on democratic freedoms and rights (E) (ep_galtan)
# Citation: Bakker et al. (2015), Polk et al. (2017), Bakker et al. (2020)

# 4.1.1 Salience of anti–establishment rhetoric (E) (ep_antielite_salience)
# Question: What is the salience of anti–establishment and anti–elite rhetoric? Responses:
# Citation: Bakker et al. (2015), Polk et al. (2017), Bakker et al. (2020)

# 4.1.7 Populist rhetoric (E) (ep_v8_popul_rhetoric)
# Question: Where would you place each party on the following scale?
# Citation: Norris (2020)

# 2.1 Anti-Pluralism Index (D) (v2xpa_antiplural)
# Additional versions: *_codelow, *_codehigh
# Question: To what extent does the party show a lacking commitment to democratic norms prior to elections?

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_antiplural, y = ep_galtan)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Anti-pluralism (V-Party)", y = "GAL-TAN (CHES)")

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_antiplural, y = ep_antielite_salience)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Anti-pluralism (V-Party)", y = "Anti-Establishment Rhetoric (CHES)")

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_antiplural, y = ep_v8_popul_rhetoric)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Anti-pluralism (V-Party)", y = "Populist/Plrualist Rhetoric (Norris 2020)")


```

```{r explore v-party data populist rhetoric}

# 2.2 Populism Index (D) (v2xpa_popul)
# Additional versions: *_codelow, *_codehigh
#Question: To what extent do representatives of the party use populist rhetoric (narrowly defined)? Scale: Interval, from low to high (0-1)

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_popul, y = ep_galtan)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Populism Index (V-Party)", y = "GAL-TAN (CHES)")

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_popul, y = ep_antielite_salience)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Populism Index (V-Party)", y = "Salience of Anti-establishment Rhetoric (CHES)", color = "Region", size = "Seat Share")

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_popul, y = ep_people_vs_elite)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Populism Index (V-Party)", y = "Direct v. Representative Demorcracy (CHES)", color = "Region", size = "Seat Share")

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_popul, y = ep_v9_popul_saliency)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Populism Index (V-Party)", y = "Importance of Pop. Rhetoric (Norris 2020)")

# plot vparty
ggplot(data = subset(vparty, boix_democracy == 1), mapping = aes(x = v2xpa_popul, y = ep_v8_popul_rhetoric)) +
  geom_point(alpha = 0.6, aes(size = v2paseatshare, color = as.factor(region))) +
  theme_bw() +
  #ylim(0,1) +
  #xlim(0,1) +
  #geom_text_repel(aes(label = cy),
  #                size = 3,
  #                min.segment.length = 0,
  #                point.padding = NA) +
#  facet_wrap(~ edi_high) + #, scales = "free_y") +
  #geom_abline(slope=1, color = "darkgray") +
  stat_smooth(method="loess", color="black", alpha = 0.4) +
  labs(title = "Party Positions in Democracies", x = "Populism Index (V-Party)", y = "Use of Populist v. Plrualist Rhetoric (Norris 2020)")

```




### Identify government and opposition parties

```{r merge data vparty DPI}

# Marge data: Elected representative data from DPI

# DPI
# system (pres. parl.)
vparty$system <- DPI$system[match(vparty$cy, DPI$cy)] 
# FRAC, The probability that two deputies picked at random from the legislature will be of different parties
vparty$frac <- DPI$frac[match(vparty$cy, DPI$cy)]
# FRAC, The probability that two deputies picked at random from the legislature will be of different parties
vparty$frac_orig <- DPI$frac[match(vparty$cy, DPI$cy)]# save original
# Legislative variables
# govfrac
vparty$govfrac <- DPI$govfrac[match(vparty$cy, DPI$cy)] 
# NUMVOTE, Vote share of Government Parties
vparty$numvote <- DPI$numvote[match(vparty$cy, DPI$cy)] 
# LARGEST GOVT PARTY, GOV1ME Name
vparty$gov1me <- DPI$gov1me[match(vparty$cy, DPI$cy)] 
# GOV1VOTE Vote Share
vparty$gov1vote <- DPI$gov1vote[match(vparty$cy, DPI$cy)] 
# 2nd GOVT. PARTY, GOV2ME Name
vparty$gov2me <- DPI$gov2me[match(vparty$cy, DPI$cy)] 
# GOV2VOTE Vote Share
vparty$gov2vote <- DPI$gov2vote[match(vparty$cy, DPI$cy)] 
# 3rd GOVT. PARTY, GOV3ME Name
vparty$gov3me <- DPI$gov3me[match(vparty$cy, DPI$cy)] 
# GOV3VOTE Vote Share
vparty$gov3vote <- DPI$gov3vote[match(vparty$cy, DPI$cy)] 
# OPPFRAC, The probability that two deputies from among the opposition parties will be of different parties.
vparty$oppfrac <- DPI$oppfrac[match(vparty$cy, DPI$cy)] 
# OPPVOTE, Vote Share of Opposition Parties
vparty$oppvote <- DPI$oppvote[match(vparty$cy, DPI$cy)] 
# LARGEST OPP. PARTY, OPP1ME Name
vparty$opp1me <- DPI$opp1me[match(vparty$cy, DPI$cy)] 
# OPP1VOTE Vote Share
vparty$opp1vote <- DPI$opp1vote[match(vparty$cy, DPI$cy)] 
# 2nd OPP. PARTY, OPP2ME Name
vparty$opp2me <- DPI$opp2me[match(vparty$cy, DPI$cy)] 
# OPP2VOTE Vote Share
vparty$opp2vote <- DPI$opp2vote[match(vparty$cy, DPI$cy)] 
# 3rd OPP. PARTY, OPP3ME Name
vparty$opp3me <- DPI$opp3me[match(vparty$cy, DPI$cy)] 
# OPP3VOTE Vote Share
vparty$opp3vote <- DPI$opp3vote[match(vparty$cy, DPI$cy)] 

# Fix missing frac
vparty$frac[is.na(vparty$frac)] <- vparty$oppfrac[is.na(vparty$frac)]

# Executive variables
# EXECME, Name of party executive
vparty$execme <- DPI$execme[match(vparty$cy, DPI$cy)] 
# PERCENTL, President got what % of votes in the final round?
vparty$percentl <- DPI$percentl[match(vparty$cy, DPI$cy)]
# EXECNAT, Nationalist (1 if yes) executive
vparty$execnat <- DPI$execnat[match(vparty$cy, DPI$cy)] 
#ALLHOUSE, Does party of executive control all relevant houses?
vparty$allhouse <- DPI$allhouse[match(vparty$cy, DPI$cy)] 

```

### Example: Merging Party Facts party datasets in R

From: https://partyfacts.herokuapp.com/download/

```{r merge party facts}

# download and read Party Facts mapping table
#file_name <- 'partyfacts-mapping.csv'
#if( ! file_name %in% list.files())
#    url <- 'https://partyfacts.herokuapp.com/download/external-parties-csv/'
#    download.file(url, file_name)
#partyfacts <- read.csv(file_name, as.is=TRUE)  # maybe conversion of character encoding

# show and select available datasets
#cat(paste(unique(partyfacts$dataset_key), collapse='\n'))
#dataset_1 <- 'vparty'
#dataset_2 <- 'dpi'

# merge two datasets selected
#first <- partyfacts[partyfacts$dataset_key == dataset_1, ]
#second <- partyfacts[partyfacts$dataset_key == dataset_2, ]
#merge_table <- merge(first, second, by='partyfacts_id', all=TRUE)

# write results into file with dataset names in file name
#file_out <- sprintf('partyfacts-%s-%s.csv', dataset_1, dataset_2)
#write.csv(merge_table, file_out, na='', row.names = FALSE)

```

```{r fix parties}

# Prep party names for merge
vparty$v2pashname_fix <- vparty$v2pashname
vparty$v2panaallian_fix <- vparty$v2panaallian

# Mexico
vparty$v2pashname_fix[vparty$country_name == "Mexico" & vparty$v2pashname == "MORENA"] <- "Morena"
# Sweden
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == 'S'] <- 'Social Dem'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "MP"] <- 'Green'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "KD" & vparty$year >= 2002] <- 'Kd'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "KD" & vparty$year <= 2001] <- 'Christian Democratic'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "V" & vparty$year >= 1992] <- 'Left'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "V" & vparty$year < 1990] <- 'Communist'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "V" & vparty$year < 1976] <- 'Communists'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "H/M"] <- 'Moderate'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "B/C"] <- 'CP' # Centre
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == "FP" & (vparty$year == 2006)] <- 'Liberal'
vparty$v2pashname_fix[vparty$country_name == 'Sweden' & vparty$v2pashname == 'SD'] <- 'Sd'
# Switzerland
vparty$v2pashname_fix[vparty$country_name == 'Switzerland' & vparty$v2pashname == 'SP'] <- 'Social Dem'
vparty$v2pashname_fix[vparty$country_name == 'Switzerland' & vparty$v2pashname == 'SVP'] <- 'Swiss People' # French: Union D‚àö¬©mocratique du Centre,  national-conservative and right-wing populist
vparty$v2pashname_fix[vparty$country_name == 'Switzerland' & vparty$v2pashname == 'FDP'] <- 'Radical Dem'
vparty$v2pashname_fix[vparty$country_name == 'Switzerland' & vparty$v2pashname == 'Grue'] <- 'Greens'
vparty$v2pashname_fix[vparty$country_name == 'Switzerland' & vparty$v2pashname == 'GPL'] <- 'Green Liberal'
vparty$v2pashname_fix[vparty$country_name == 'Switzerland' & vparty$v2pashname == 'LdU' & vparty$year == 1975] <- 'independent Alliance'
vparty$v2pashname_fix[vparty$country_name == 'Switzerland' & vparty$v2pashname == 'KK/CVP'] <- 'Chr. Dem'
# Japan
vparty$v2pashname_fix[vparty$country_name == 'Japan' & vparty$v2pashname == 'JSP/SDP'] <- 'Socialist'
vparty$v2pashname_fix[vparty$country_name == 'Japan' & vparty$v2pashname == 'JSP/SDP' & vparty$year >= 1993] <- 'SDPJ'
vparty$v2pashname_fix[vparty$country_name == 'Japan' & vparty$v2pashname == 'DSP'] <- 'Dem. Soc.'
vparty$v2pashname_fix[vparty$country_name == 'Japan' & vparty$v2pashname == 'DPJ' & vparty$year == 1996] <- 'SDPJ'
vparty$v2pashname_fix[vparty$country_name == 'Japan' & vparty$v2pashname == 'K' & vparty$year < 2000] <- 'Komeito'
vparty$v2pashname_fix[vparty$country_name == 'Japan' & vparty$v2pashname == 'K' & vparty$year >= 2000] <- 'New Komeito'
# United States
vparty$v2pashname_fix[vparty$country_name == 'United States of America' & vparty$v2pashname == 'Rep'] <- 'Republicans'
vparty$v2pashname_fix[vparty$country_name == 'United States of America' & vparty$v2pashname == 'Dem'] <- 'Democrats'
# Colombia
vparty$gov1me[vparty$country_name == 'Colombia' & vparty$gov1me == 'Conserv.'] <- 'PCC'
vparty$gov2me[vparty$country_name == 'Colombia' & vparty$gov2me == 'Conserv.'] <- 'PCC'
vparty$gov3me[vparty$country_name == 'Colombia' & vparty$gov3me == 'Conserv.'] <- 'PCC'
vparty$opp1me[vparty$country_name == 'Colombia' & vparty$opp1me == 'Conserv.'] <- 'PCC'
vparty$opp2me[vparty$country_name == 'Colombia' & vparty$opp2me == 'Conserv.'] <- 'PCC'
vparty$opp3me[vparty$country_name == 'Colombia' & vparty$opp3me == 'Conserv.'] <- 'PCC'
vparty$v2pashname_fix[vparty$country_name == 'Colombia' & vparty$v2pashname == 'PCC' & vparty$year == 1990] <- 'PSC'
vparty$v2pashname_fix[vparty$country_name == 'Colombia' & vparty$v2pashname == 'PLC'] <- 'PL'
vparty$v2pashname_fix[vparty$country_name == 'Colombia' & vparty$v2pashname == 'Partido-U'] <- 'PSUN'
# Brazil
vparty$v2pashname_fix[vparty$country_name == 'Brazil' & vparty$v2pashname == 'PPB'] <- 'PP'
# Portugal
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'PPD/PSD'] <- 'PSD' 
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'PPD/PSD' & vparty$year == 1976] <- 'PPD' 
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'PPD/PSD'& vparty$year == 2015] <- 'PSD/CDS-PP' #PRT 2015 PPD/PSD
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'AD'] <- 'AD (PSD+CDS)'
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'CDS / PP' & vparty$year >= 1992 & vparty$year < 2005] <- 'PP'
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'CDS / PP' & vparty$year < 1992] <- 'CDS'
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'CDS / PP' & vparty$year >= 2005] <- 'CDS-PP'
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'PCP' & vparty$year >= 1983] <- 'APU'
vparty$v2pashname_fix[vparty$country_name == 'Portugal' & vparty$v2pashname == 'CDU' & vparty$year >= 2013] <- 'PCP-PEV'
# Honduras
vparty$v2pashname_fix[vparty$country_name == 'Honduras' & vparty$v2pashname == 'PLH'] <- 'PL'
vparty$v2pashname_fix[vparty$country_name == 'Honduras' & vparty$v2pashname == 'PNH'] <- 'PN'
# Pakistan
vparty$v2pashname_fix[vparty$country_name == 'Pakistan' & vparty$v2pashname == 'PPP' & vparty$year >=2003] <- 'PPPP'
vparty$v2pashname_fix[vparty$country_name == 'Pakistan' & vparty$v2pashname == 'PML(Q)'] <- 'PML-Q' # boycott of election?
vparty$v2pashname_fix[vparty$country_name == 'Pakistan' & vparty$v2pashname == 'PPP' & vparty$year >= 1990 & vparty$year <= 1993] <- 'PDA' # 1993, 1990 alliances
vparty$v2panaallian_fix[vparty$country_name == 'Pakistan' & vparty$v2pashname == 'PML(N)' & (vparty$year >= 1993)] <- 'PML-N' # 1997
vparty$v2pashname_fix[vparty$country_name == 'Pakistan' & vparty$v2pashname == 'PML(N)' & (vparty$year >= 1993)] <- 'PML' # 1997
vparty$v2pashname_fix[vparty$country_name == 'Pakistan' & vparty$v2pashname == 'PML(N)' & vparty$year == 1993] <- 'IJI' # 1993 alliances
# Taiwan
vparty$v2pashname_fix[vparty$country_name == 'Taiwan' & vparty$v2pashname == 'DDP'] <- 'DPP'
vparty$v2pashname_fix[vparty$country_name == 'Taiwan' & vparty$v2pashname == 'C/NP'] <- 'New Party'
# Canada
vparty$v2pashname_fix[vparty$country_name == 'Canada' & vparty$v2pashname == 'RPC'] <- 'Reform P.'
vparty$v2panaallian_fix[vparty$country_name == 'Canada' & vparty$v2pashname == 'RPC' & vparty$year == 2000] <- 'Canadian Alliance'
vparty$v2pashname_fix[vparty$country_name == 'Canada' & vparty$v2pashname == 'LP'] <- 'LPC'
# Chile
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2panaallian == 'Concert of Parties for Democracy'] <- 'CPD'
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2panaallian == 'Concert & Together We Can for more democracy'] <- 'CPD'
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2panaallian == 'Coalition for Change'] <- 'CC'
vparty$v2pashname_fix[vparty$country_name == 'Chile' & vparty$v2pashname == 'RN'] <- 'PRN'
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2panaallian == 'Chile Vamos'] <- 'LetÕs Go Chile'
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2panaallian == 'Alliance for Chile'] <- 'Alianza por Chile'
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2panaallian == 'The Force of the Majority/Democratic Convergence'] <- 'Democratic Convergence'
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2pashname == 'RN' & vparty$year >= 2005 & vparty$year < 2009] <- 'Alianza por Chile'
vparty$v2panaallian_fix[vparty$country_name == 'Chile' & vparty$v2pashname == 'UDI' & vparty$year >= 2005 & vparty$year < 2009] <- 'Alianza por Chile'
# Indonesia
vparty$v2pashname_fix[vparty$country_name == 'Indonesia' & vparty$v2pashname == 'PDIP'] <- 'PDI-P'
# Ireland
vparty$v2pashname_fix[vparty$country_name == 'Ireland' & vparty$v2pashname == 'Lab'] <- 'Labour'
vparty$v2pashname_fix[vparty$country_name == 'Ireland' & vparty$v2pashname == 'FF'] <- 'Fianna Fail'
vparty$v2pashname_fix[vparty$country_name == 'Ireland' & vparty$v2pashname == 'FG'] <- 'Fine Gael'
vparty$v2pashname_fix[vparty$country_name == 'Ireland' & vparty$v2pashname == 'SF'] <- 'Sinn Fein'
# Spain
vparty$v2pashname_fix[vparty$country_name == 'Spain' & vparty$v2pashname == 'AP / PP' & vparty$year >= 1989] <- 'PP'
vparty$v2pashname_fix[vparty$country_name == 'Spain' & vparty$v2pashname == 'AP / PP' & vparty$year < 1989] <- 'AP'
vparty$v2pashname_fix[vparty$country_name == 'Spain' & vparty$v2pashname == 'AP / PP' & vparty$year ==1982] <- 'AP/PSP'
vparty$v2pashname_fix[vparty$country_name == 'Spain' & vparty$v2pashname == 'PSOE' & vparty$year < 2000 & vparty$year >= 1986 & vparty$year != 1996] <- 'PSOE/PSC'
# Mozambique
vparty$v2pashname_fix[vparty$country_name == 'Mozambique' & vparty$v2pashname == 'FRELIMO'] <- 'Frelimo'
vparty$v2pashname_fix[vparty$country_name == 'Mozambique' & vparty$v2pashname == 'RENAMO'] <- 'Renamo'
# Australia
vparty$v2pashname_fix[vparty$country_name == 'Australia' & vparty$v2pashname == 'ACP-NPA'] <- 'NPA'
vparty$v2pashname_fix[vparty$country_name == 'Australia' & vparty$v2pashname == 'LNPQ'] <- 'LNP'
# Ecuador
vparty$v2pashname_fix[vparty$country_name == 'Ecuador' & vparty$v2pashname == 'UDC/DP' & vparty$year >=1997 & vparty$year <= 1998] <- 'DP'
# Guatemala
vparty$v2pashname_fix[vparty$country_name == 'Guatemala' & vparty$v2pashname == 'DCG'] <- 'PDCG'
vparty$v2pashname_fix[vparty$country_name == 'Guatemala' & vparty$v2pashname == 'FCN'] <- 'FCN Nacion'
vparty$v2pashname_fix[vparty$country_name == 'Guatemala' & vparty$v2pashname == 'T'] <- 'TODOS'
# United Kingdom
vparty$v2pashname_fix[vparty$country_name == 'United Kingdom' & vparty$v2pashname == 'Lib'] <- 'Liberal'
vparty$v2pashname_fix[vparty$country_name == 'United Kingdom' & vparty$v2pashname == 'Lab'] <- 'Labour'
vparty$v2pashname_fix[vparty$country_name == 'United Kingdom' & vparty$v2pashname == 'Con'] <- 'Conservative'
# Hungary
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz'] <- "FiDeSz"
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz' & vparty$year >=2014 & vparty$year <= 2018] <- 'FiDeSz-CDPP'
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz' & vparty$year == 2006] <- 'FiDeSz-MPSz-KDNP'
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz' & vparty$year == 2002] <- 'FiDeSz'
vparty$v2panaallian_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz' & vparty$year == 2002] <- 'FiDeSz-MPSz-MDF'
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'KDNP' & vparty$year == 2006] <- 'FiDeSz-MPSz-KDNP'
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'MSZP'] <- 'MSzP'
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'MSZP' & vparty$year >=2006 & vparty$year < 2014] <- 'MSzP-SzDSz'
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'MSZP' & vparty$year >=2014 & vparty$year <= 2018] <- 'MszP-PM'
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'SzDSz' & vparty$year ==2006] <- 'MSzP-SzDSz'
vparty$v2panaallian_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz‚ÄìKDNP'] <- 'FiDeSz-CDPP'
vparty$v2panaallian_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz' & vparty$year == 2010] <- 'FiDeSz-CDPP' 
vparty$v2pashname_fix[vparty$country_name == 'Hungary' & vparty$v2pashname == 'Fidesz' & vparty$year == 2010] <- 'FiDeSz-MPSz' 
# New Zealand 
vparty$v2pashname_fix[vparty$country_name == 'New Zealand' & vparty$v2pashname == 'NP'] <- 'National Party'
vparty$v2pashname_fix[vparty$country_name == 'New Zealand' & vparty$v2pashname == 'LP'] <- 'Labour Party'
vparty$v2pashname_fix[vparty$country_name == 'New Zealand' & vparty$v2pashname == 'Greens'] <- 'Green'
vparty$v2pashname_fix[vparty$country_name == 'New Zealand' & vparty$v2pashname == 'NZFP'] <- 'NZ First'
# Malta 
vparty$v2pashname_fix[vparty$country_name == 'Malta' & vparty$v2pashname == 'PN'] <- 'NP'
# Argentina 
vparty$v2pashname_fix[vparty$country_name == 'Argentina' & vparty$v2pashname == 'FREPASO'] <- 'Frepaso'
vparty$v2pashname_fix[vparty$country_name == 'Argentina' & vparty$v2pashname == 'FPV-PJ'] <- 'FPV'
vparty$v2panaallian_fix[vparty$country_name == 'Argentina' & vparty$v2pashname == 'FPV-PJ'] <- 'PJ'
vparty$v2pashname_fix[vparty$country_name == 'Argentina' & vparty$v2pashname == 'PJ' & vparty$year <= 1984] <- 'FJDL'
vparty$v2pashname_fix[vparty$country_name == 'Argentina' & vparty$v2panaallian == 'Aliance for Work, Justice, and Education' & vparty$year > 1997] <- 'ATJE'
vparty$v2pashname_fix[vparty$country_name == 'Argentina' & vparty$v2pashname == 'UCR' & vparty$year > 1997 & vparty$year <= 2001] <- 'ATJE'
vparty$v2panaallian_fix[vparty$country_name == 'Argentina' & vparty$v2panaallian == 'Aliance for Work, Justice, and Education' & vparty$year <= 1997] <- 'UCR/Frepaso'
# Italy
vparty$v2panaallian_fix[vparty$country_name == 'Italy' & vparty$v2panaallian == 'House of Freedoms'] <- 'Casa delle Liberta'
vparty$v2panaallian_fix[vparty$country_name == 'Italy' & vparty$v2panaallian == 'The Union'] <- "L'Unione" # apostrophe
vparty$v2panaallian_fix[vparty$country_name == 'Italy' & vparty$v2panaallian == 'The Olive Tree'] <- 'Ulivo Alliance'
vparty$v2panaallian_fix[vparty$country_name == 'Italy' & vparty$v2panaallian == 'The Olive Tree' & vparty$year == 2001] <- "L'Ulivo"
vparty$v2panaallian_fix[vparty$country_name == 'Italy' & vparty$v2panaallian == 'Pact for Italy'] <- 'Pact of Italy'
vparty$v2panaallian_fix[vparty$country_name == 'Italy' & vparty$v2panaallian == 'Pole for Freedoms'] <- 'Polo per le Liberta'
vparty$v2pashname_fix[vparty$country_name == 'Italy' & vparty$v2pashname == 'PCI'] <- 'Communist'
vparty$v2pashname_fix[vparty$country_name == 'Italy' & vparty$v2pashname == 'PSI'] <- 'Socialists'
vparty$v2pashname_fix[vparty$country_name == 'Italy' & vparty$v2pashname == 'IPdL'] <- 'PdL'
# Guyana 
vparty$v2pashname_fix[vparty$country_name == 'Guyana' & vparty$v2pashname == 'PPP' & vparty$year >= 1991] <- 'PPP/C'
vparty$v2pashname_fix[vparty$country_name == 'Guyana' & vparty$v2pashname == 'PPP' & (vparty$year == 1992 | vparty$year == 1997)] <- 'PPP'
vparty$v2pashname_fix[vparty$country_name == 'Guyana' & vparty$v2pashname == 'PNC' & vparty$year >= 2001 & vparty$year <= 2006] <- 'PNCR-1G'
vparty$v2panaallian_fix[vparty$country_name == 'Guyana' & vparty$v2panaallian == 'APNU+AFC'] <- 'APNU-AFC'
vparty$v2pashname_fix[vparty$country_name == 'Guyana' & vparty$v2pashname == 'APNU' & vparty$year == 2011] <- 'PNU'
# Peru 
vparty$v2pashname_fix[vparty$country_name == 'Peru' & vparty$v2pashname == 'APRA/PAP' & vparty$year >= 2006] <- 'PAP'
vparty$v2pashname_fix[vparty$country_name == 'Peru' & vparty$v2pashname == 'APRA/PAP' & vparty$year < 2006] <- 'APRA'
vparty$v2pashname_fix[vparty$country_name == 'Peru' & vparty$v2pashname == 'IU'] <- 'United Left'
vparty$v2pashname_fix[vparty$country_name == 'Peru' & vparty$v2pashname == 'Frente Amplio'] <- 'FA'
vparty$v2panaallian_fix[vparty$country_name == 'Peru' & vparty$v2panaallian == 'Alianza Electoral Per√∫ Posible'] <- 'Peru Posible'
vparty$v2pashname_fix[vparty$country_name == 'Peru' & vparty$v2pashname == 'FP' & vparty$year >= 2006] <- 'Fuerza 2011'
vparty$v2pashname_fix[vparty$country_name == 'Peru' & vparty$v2pashname == 'PNP' & vparty$year == 2011] <- 'Gana Peru'
vparty$v2pashname_fix[vparty$country_name == 'Peru' & vparty$v2pashname == 'Alianza Por ...'] <- 'Alianza Por El Gran Cambio'
# Poland 
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'K'] <- "Kukiz'15" # apostrophe
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'PO' & vparty$year >= 2019] <- "KO"
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'SLD' & vparty$year < 1993] <- "Dem. Left Alliance"
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'SLD' & vparty$year >= 2019] <- "Lewica"
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'SLD' & (vparty$year == 2001)] <- "SLD-UP"
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'UW-PD'] <- "UW" 
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'UW-PD' & vparty$year == 1991] <- "UD"
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'ZChN'] <- "ZCH-N" 
vparty$v2pashname_fix[vparty$country_name == 'Poland' & vparty$v2pashname == 'SRP'] <- "SDBRP" 
# Turkey 
vparty$v2pashname_fix[vparty$country_name == 'Turkey' & vparty$v2pashname == 'ANAP'] <- "Motherland"
vparty$v2pashname_fix[vparty$country_name == 'Turkey' & vparty$v2pashname == 'AP'] <- "Justice P."
vparty$v2pashname_fix[vparty$country_name == 'Turkey' & vparty$v2pashname == 'HP'] <- "Populist"
vparty$v2pashname_fix[vparty$country_name == 'Turkey' & vparty$v2pashname == 'CHP' & vparty$year <= 1980] <- "RPP"
vparty$v2pashname_fix[vparty$country_name == 'Turkey' & vparty$v2pashname == 'CHP' & vparty$year >= 1980 & vparty$year <= 1986] <- "Populist"
vparty$v2pashname_fix[vparty$country_name == 'Turkey' & vparty$v2pashname == 'SHP' & vparty$year >= 1991 & vparty$year <= 1995] <- "SHP/IP"
vparty$v2pashname_fix[vparty$country_name == 'Turkey' & vparty$v2pashname == 'CHP' & vparty$year == 1987] <- "SHP"
# Senegal 
vparty$v2pashname_fix[vparty$country_name == 'Senegal' & vparty$v2pashname == 'PDS' & vparty$year >= 2000 & vparty$year <= 2001] <- "Sopi Coalition"
vparty$v2pashname_fix[vparty$country_name == 'Senegal' & vparty$v2pashname == 'PS/UPS'] <- "PS"
vparty$v2pashname_fix[vparty$country_name == 'Senegal' & vparty$v2pashname == 'APR'] <- "APR-Yakaar"
vparty$v2panaallian_fix[vparty$country_name == 'Senegal' & vparty$v2panaallian == 'United in Hope coalition'] <- 'BBY'
vparty$v2panaallian_fix[vparty$country_name == 'Senegal' & vparty$v2panaallian == 'Benno Bokk Yakaar Coalition'] <- 'BBY' 
vparty$v2panaallian_fix[vparty$country_name == 'Senegal' & vparty$v2panaallian == 'Winning Coalition Wattu Senegal'] <- 'BBY' 
# Paraguay 
vparty$v2pashname_fix[vparty$country_name == 'Paraguay' & vparty$v2pashname == 'ANR-PC'] <- "Colorado"
vparty$v2pashname_fix[vparty$country_name == 'Paraguay' & vparty$v2pashname == 'PPQ'] <- "PQ"
vparty$v2pashname_fix[vparty$country_name == 'Paraguay' & vparty$v2pashname == 'UNACE'] <- "UNCE"
# Fiji 
vparty$v2pashname_fix[vparty$country_name == 'Fiji' & vparty$v2pashname == 'FF'] <- "FijiFirst"
vparty$v2pashname_fix[vparty$country_name == 'Fiji' & vparty$v2pashname == 'AP'] <- "Alliance"
vparty$v2pashname_fix[vparty$country_name == 'Fiji' & vparty$v2pashname == 'SDLP'] <- "SODELPA"
vparty$v2pashname_fix[vparty$country_name == 'Fiji' & vparty$v2pashname == 'NFP-F'] <- "Nat. Federation F."
vparty$v2pashname_fix[vparty$country_name == 'Fiji' & vparty$v2pashname == 'NFP-D'] <- "Nat. Fed. P" # FNP Nationalist, see 1977 election
vparty$v2pashname_fix[vparty$country_name == 'Fiji' & vparty$v2pashname == 'NFP'] <- "Nat. Fed. P"
# South Korea 
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'Uri'] <- "Uri Party"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'HD-SD' & vparty$year < 2012] <- "GNP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'HD-SD' & vparty$year >= 2012 & vparty$year < 2016] <- "NFP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'MK/SH' & vparty$year == 1996] <- "NKP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'MK/SH' & vparty$year == 1992] <- "DLP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'PPD'] <- "PDP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'DPK'] <- "Minjoo"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'LFP / AUP'] <- "LFP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'MD'] <- "UDP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'NUP'] <- "UPP"
vparty$v2pashname_fix[vparty$country_name == 'South Korea' & vparty$v2pashname == 'LKP' & vparty$year >= 2016] <- "NFP" # Saenuri Party (New Frontier Party)
# Georgia 
vparty$v2pashname_fix[vparty$country_name == 'Georgia' & vparty$v2pashname == 'ENM'] <- "UNM"
vparty$v2pashname_fix[vparty$country_name == 'Georgia' & vparty$v2pashname == 'GD'] <- "GD-DG"
vparty$v2pashname_fix[vparty$country_name == 'Georgia' & vparty$v2pashname == 'United Oppos...'] <- "Joint Opposition"
# Philippines 
vparty$v2pashname_fix[vparty$country_name == 'Philippines' & vparty$v2pashname == 'Lakas-CMD' & vparty$year != 2010] <- "Lakas N"
vparty$v2pashname_fix[vparty$country_name == 'Philippines' & vparty$v2pashname == 'KMB'] <- "NPC"
vparty$v2pashname_fix[vparty$country_name == 'Philippines' & vparty$v2pashname == 'PLP'] <- "LP"
vparty$v2pashname_fix[vparty$country_name == 'Philippines' & vparty$v2pashname == 'PNP'] <- "NP"
vparty$v2pashname_fix[vparty$country_name == 'Philippines' & vparty$v2pashname == 'LAMMP'] <- "LaMMP"
vparty$v2pashname_fix[vparty$country_name == 'Philippines' & vparty$v2pashname == 'Lakas-NUCD/ LDP'] <- "Lakas N"
vparty$v2pashname_fix[vparty$country_name == 'Philippines' & vparty$v2pashname == 'UNIDO'] <- "Unido"
vparty$v2panaallian_fix[vparty$country_name == 'Philippines' & vparty$v2panaallian == 'LABAN coalition'] <- "LDP/Allies"
# Uganda 
vparty$v2pashname_fix[vparty$country_name == 'Uganda' & vparty$v2pashname == 'DP'] <- "Dem. Party"
# Trinidad and Tobago
vparty$v2pashname_fix[vparty$country_name == 'Trinidad and Tobago' & vparty$v2pashname == 'NAR' & vparty$year == 1981] <- "TTNA"
# Germany 
vparty$v2panaallian_fix[vparty$country_name == 'Germany' & vparty$v2panaallian == 'Christian Democratic Union / Christian Social Union(CDU/CSU)'] <- "CDU/CSU"
# El Salvador 
vparty$v2pashname_fix[vparty$country_name == 'El Salvador' & vparty$v2pashname == 'PCN' & vparty$year >= 2013] <- "CN"
# Bangladesh 
vparty$v2pashname_fix[vparty$country_name == 'Bangladesh' & vparty$v2pashname == 'BAL'] <- "AL"
# Bolivia 
vparty$v2pashname_fix[vparty$country_name == 'Bolivia' & vparty$v2pashname == 'MNR' & vparty$year >= 1983 & vparty$year <= 1990] <- "MNRH"
vparty$v2pashname_fix[vparty$country_name == 'Bolivia' & vparty$v2pashname == 'Podemos'] <- "PODEMOS"
vparty$v2pashname_fix[vparty$country_name == 'Bolivia' & vparty$v2pashname == 'CONDEPA'] <- "Condepa"
# South Africa 
vparty$v2pashname_fix[vparty$country_name == 'South Africa' & vparty$v2pashname == 'EEF'] <- "EFF"
vparty$v2pashname_fix[vparty$country_name == 'South Africa' & vparty$v2pashname == 'NP'] <- "National Party" #1994
# India
vparty$v2pashname_fix[vparty$country_name == 'India' & vparty$v2pashname == 'BJP' & vparty$year >= 2004 & vparty$year <= 2013] <- "NDA"
vparty$v2pashname_fix[vparty$country_name == 'India' & vparty$v2pashname == 'JP'] <- "Lok Dal"
vparty$v2pashname_fix[vparty$country_name == 'India' & vparty$v2pashname == 'JNP'] <- "Janata Party"
vparty$v2pashname_fix[vparty$country_name == 'India' & vparty$v2pashname == 'INC' & vparty$year <= 1979] <- "Congress"
vparty$v2panaallian_fix[vparty$country_name == 'India' & vparty$v2pashname == 'INC' & vparty$year == 2009] <- "UDA"
vparty$v2pashname_fix[vparty$country_name == 'India' & vparty$v2pashname == 'JD' & vparty$year == 1989] <- "National Front"
vparty$v2pashname_fix[vparty$country_name == 'India' & vparty$v2pashname == 'CPI(M)' & vparty$year <= 1989] <- "M-Communist"
vparty$v2pashname_fix[vparty$country_name == 'India' & vparty$v2pashname == 'CPI(M)' & vparty$year >= 1990] <- "CPI-M"
# Thailand 
vparty$v2pashname_fix[vparty$country_name == 'Thailand' & vparty$v2pashname == 'PP'] <- "DP"
vparty$v2pashname_fix[vparty$country_name == 'Thailand' & vparty$v2pashname == 'PCT'] <- "Chart Thai"
vparty$v2pashname_fix[vparty$country_name == 'Thailand' & vparty$v2pashname == 'PKS'] <- "Social Action"
# Benin 
vparty$v2pashname_fix[vparty$country_name == 'Benin' & vparty$v2pashname == 'FARD'] <- "FARD- Alafia"
vparty$v2pashname_fix[vparty$country_name == 'Benin' & vparty$v2pashname == 'UTRD'] <- 'UTDR'
vparty$v2panaallian_fix[vparty$country_name == 'Benin' & vparty$v2panaallian == 'Alliance RB-RP (Benin Rebirth Party-Patriotic Revival Party)'] <- "RB-PRP"
# Indonesia 
vparty$v2pashname_fix[vparty$country_name == 'Indonesia' & vparty$v2pashname == 'Gerindra'] <- "Gerinda"
vparty$v2pashname_fix[vparty$country_name == 'Indonesia' & vparty$v2pashname == 'Nasdem'] <- "NasDem"
# Nepal
vparty$v2pashname_fix[vparty$country_name == 'Nepal' & vparty$v2pashname == 'CPN-UML' & vparty$year <= 2002] <- "UML"
vparty$v2pashname_fix[vparty$country_name == 'Nepal' & vparty$v2pashname == 'CPN-UML' & vparty$year >= 2008] <- "CPN (UML)"
# Nicaragua 
vparty$v2pashname_fix[vparty$country_name == 'Nicaragua' & vparty$v2pashname == 'Liberal Alli...'] <- "AL"
# Niger 
vparty$v2pashname_fix[vparty$country_name == 'Niger' & vparty$v2pashname == 'MODEN/FA'] <- "MODEN"
vparty$v2pashname_fix[vparty$country_name == 'Niger' & vparty$v2pashname == 'MNSD-N' & (vparty$year == 2004|vparty$year == 1999)] <- "MNSD"
# Burundi 
vparty$v2pashname_fix[vparty$country_name == 'Burundi' & vparty$v2pashname == 'FRODEBU'] <- "Frodebu"
# Costa Rica 
vparty$v2pashname_fix[vparty$country_name == 'Costa Rica' & vparty$v2pashname == 'PRN'] <- "RN"
vparty$v2pashname_fix[vparty$country_name == 'Costa Rica' & vparty$v2pashname == 'UC' & vparty$year <= 1978] <- "PUO"
vparty$v2pashname_fix[vparty$country_name == 'Costa Rica' & vparty$v2pashname == 'UC' & vparty$year >= 1979] <- "CU"
vparty$v2panaallian_fix[vparty$country_name == 'Costa Rica' & vparty$v2pashname == 'UC'] <- "CU Unity Coalition"
# France
vparty$v2pashname_fix[vparty$country_name == 'France' & vparty$v2pashname == 'PCF'] <- "Communist"
vparty$v2pashname_fix[vparty$country_name == 'France' & vparty$v2pashname == 'PS' & vparty$year == 1981] <- "PS/MRG"
# Germany
vparty$v2pashname_fix[vparty$country_name == 'Germany' & vparty$v2pashname == 'Linke'] <- "Left"
vparty$v2pashname_fix[vparty$country_name == 'Germany' & vparty$v2pashname == 'B90/Grue'] <- "Alliance90/Greens"
# Latvia
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'V' & vparty$year <= 2012] <- "Unity"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'V' & vparty$year > 2012] <- "UNITY" 
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'NA/TB/LNNK'] <- "TB/LNNK"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'NA/TB/LNNK' & vparty$year >= 2011 & vparty$year <= 2014] <- "NA-VL-TB/LNNK"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'LSDSP'] <- "LSP"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'TKL-ZP'] <- "PML"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'JKP'] <- "JKV"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'TB' & vparty$year <= 1997] <- "UFF"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'LPP/LC'] <- "LPP-LC"
vparty$v2pashname_fix[vparty$country_name == 'Latvia' & vparty$v2pashname == 'PCTVL'] <- "LSP-NHP"
# Lesotho
vparty$v2pashname_fix[vparty$country_name == 'Lesotho' & vparty$v2pashname == 'LeCofoDe'] <- "LCD"
# Malawi
vparty$v2pashname_fix[vparty$country_name == 'Malawi' & vparty$v2pashname == 'AFORD'] <- "Aford"
# Mongolia
vparty$v2pashname_fix[vparty$country_name == 'Mongolia' & vparty$v2pashname == 'MAN' & vparty$year <= 2012] <- "MPRP"
vparty$v2pashname_fix[vparty$country_name == 'Mongolia' & vparty$v2pashname == 'MAN' & vparty$year > 2012] <- "MPP"
vparty$v2pashname_fix[vparty$country_name == 'Mongolia' & vparty$v2pashname == 'AN' & vparty$year <= 2003] <- "MNDP"
vparty$v2pashname_fix[vparty$country_name == 'Mongolia' & vparty$v2pashname == 'AN' & vparty$year >= 2004] <- "DP"
# Panama
vparty$v2pashname_fix[vparty$country_name == 'Panama' & vparty$v2pashname == 'PPA' & vparty$year >= 1990] <- "PRD"
vparty$v2pashname_fix[vparty$country_name == 'Panama' & vparty$v2pashname == 'MOLIRENA'] <- "Molirena"
vparty$v2panaallian_fix[vparty$country_name == 'Panama' & vparty$v2pashname == 'CD' & vparty$year == 2009] <- "AC" # Alliance for Change
# Mauritius
vparty$v2panaallian_fix[vparty$country_name == 'Mauritius' & vparty$v2panaallian == 'Alliance MSM - MMM'] <- "MSM-MMM"
vparty$v2pashname_fix[vparty$country_name == 'Mauritius' & vparty$v2panaallian == 'MSM / MLP / PMSD'] <- "MSM"
vparty$v2panaallian_fix[vparty$country_name == 'Mauritius' & vparty$v2panaallian == 'MSM / MLP / PMSD'] <- "MSM/Labour"
vparty$v2pashname_fix[vparty$country_name == 'Mauritius' & vparty$v2panaallian == 'Alliance (MSM / Labour)'] <- "MSM"
vparty$v2panaallian_fix[vparty$country_name == 'Mauritius' & vparty$v2pashname == 'IP'] <- "IP"
vparty$v2pashname_fix[vparty$country_name == 'Mauritius' & vparty$v2pashname == 'IP'] <- "Labour"
vparty$v2pashname_fix[vparty$country_name == 'Mauritius' & vparty$v2pashname == 'PT' & vparty$year == 1995] <- "MLP"
vparty$v2panaallian_fix[vparty$country_name == 'Mauritius' & vparty$v2pashname == 'PTR-MMM' & vparty$year == 2014] <- "MLP-MMM"
# Ukraine
vparty$v2pashname_fix[vparty$country_name == 'Ukraine' & vparty$v2pashname == 'BYuT'] <- "BYT"
vparty$v2pashname_fix[vparty$country_name == 'Ukraine' & vparty$v2pashname == 'NUNS' & vparty$year <= 2006] <- "NSNU"
vparty$v2pashname_fix[vparty$country_name == 'Ukraine' & vparty$v2pashname == 'NUNS' & vparty$year >= 2007] <- "NU-NS"
vparty$v2pashname_fix[vparty$country_name == 'Ukraine' & vparty$v2pashname == 'NUNS' & vparty$year == 2002] <- "OU"
vparty$v2pashname_fix[vparty$country_name == 'Ukraine' & vparty$v2pashname == 'KPU' & vparty$year <= 2006] <- "CPU"
vparty$v2pashname_fix[vparty$country_name == 'Ukraine' & vparty$v2pashname == 'ZYU'] <- "FUU"
vparty$v2pashname_fix[vparty$country_name == 'Ukraine' & vparty$v2pashname == 'SN'] <- "Servant of the People"
# Uruguay
vparty$v2pashname_fix[vparty$country_name == 'Uruguay' & vparty$v2pashname == 'PC'] <- "Colorado"
vparty$v2pashname_fix[vparty$country_name == 'Uruguay' & vparty$v2pashname == 'FA/EP' & vparty$year < 2003] <- "EP"
vparty$v2pashname_fix[vparty$country_name == 'Uruguay' & vparty$v2pashname == 'FA/EP' & vparty$year >= 2004] <- "EP-FA"
# Gambia
vparty$v2pashname_fix[vparty$country_name == 'The Gambia' & vparty$v2pashname == 'UDP'] <- "UDC"
# Madagascar
vparty$v2pashname_fix[vparty$country_name == 'Madagascar' & vparty$v2pashname == 'MAPAR / IRD'] <- "IRD"
vparty$v2panaallian_fix[vparty$country_name == 'Madagascar' & vparty$v2panaallian == 'National Union (FP)'] <- "FP"
# Moldova
# Note: 1998 elections has MMDP as both opposition and gov?
vparty$v2pashname_fix[vparty$country_name == 'Moldova' & vparty$v2pashname == 'PCRM' & vparty$year == 1998] <- "PCM"
vparty$v2pashname_fix[vparty$country_name == 'Moldova' & vparty$v2pashname == 'CDM'] <- "MMDP"
vparty$v2panaallian_fix[vparty$country_name == 'Moldova' & vparty$v2pashname == 'BEAB'] <- "Braghis Alliance"
vparty$v2panaallian_fix[vparty$country_name == 'Moldova' & vparty$v2pashname == 'PAS' & vparty$year == 2019] <- "ACUM"
vparty$v2pashname_fix[vparty$country_name == 'Moldova' & vparty$v2panaallian == "Electoral Bloc of the Socialist Party and the Movement ‚ÄòUnity'"] <- "PS"
# Austria
vparty$v2pashname_fix[vparty$country_name == 'Austria' & vparty$v2pashname == 'GRUENE' & vparty$year <= 2008] <- "GAL"
vparty$v2pashname_fix[vparty$country_name == 'Austria' & vparty$v2pashname == 'GRUENE' & vparty$year > 2008] <- "DG"
# Belgium
# Note: check 2007 election
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PVV-OVLD' & vparty$year < 1981] <- "Freedom & Prog"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PVV-OVLD' & vparty$year >= 1981 & vparty$year <= 1994] <- "PVV"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PVV-OVLD' & vparty$year >= 1995] <- "VLD"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'N-VA' & vparty$year == 2019] <- "NV-A"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PS' & vparty$year <= 1985] <- "Socialist"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'CVP' & vparty$year >= 2003] <- "CD&V"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'CVP' & vparty$year <= 1978] <- "CSP"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'SPA' & vparty$year <= 1995] <- "SP"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'SPA' & vparty$year <= 1985] <- "Socialist"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'VB' & vparty$year == 2019] <- "Vlaam Belang"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'BSP-PSB'] <- "Socialist"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PRL' & vparty$year == 1999] <- "PRL-FDF"
vparty$v2pashname_fix[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PSC' & vparty$year <= 1978] <- "CDH"
# Bosnia and Herzegovina
vparty$v2pashname_fix[vparty$country_name == 'Bosnia and Herzegovina' & vparty$v2pashname == 'SDP-BiH' & vparty$year <= 2006]<- "SBiH" 
vparty$v2pashname_fix[vparty$country_name == 'Bosnia and Herzegovina' & vparty$v2pashname == 'SDP-BiH' & vparty$year >= 2010]<- "SDP"
vparty$v2pashname_fix[vparty$country_name == 'Bosnia and Herzegovina' & vparty$v2pashname == 'DF'] <- "Democratic Front"
vparty$v2pashname_fix[vparty$country_name == 'Bosnia and Herzegovina' & vparty$v2pashname == 'HDZ-BiH'] <- "HDZ-HNZ"
# Bulgaria
vparty$v2pashname_fix[vparty$country_name == 'Bulgaria' & vparty$v2pashname == 'NDSV'] <- "NMSII"
vparty$v2pashname_fix[vparty$country_name == 'Bulgaria' & vparty$v2pashname == 'KzB/BSP'] <- "BSP"
vparty$v2pashname_fix[vparty$country_name == 'Bulgaria' & vparty$v2pashname == 'KzB/BSP' & (vparty$year == 1994 | vparty$year == 1997)] <- "BSP/Allies"
vparty$v2pashname_fix[vparty$country_name == 'Bulgaria' & vparty$v2pashname == 'KzB/BSP' & (vparty$year == 2005 | vparty$year == 2009)] <- "KZB"
vparty$v2panaallian_fix[vparty$country_name == 'Bulgaria' & vparty$v2panaallian == 'Coalition for Bulgaria | Democratic Left' & (vparty$year == 2001)] <- "CB"
vparty$v2pashname_fix[vparty$country_name == 'Bulgaria' & vparty$v2pashname == 'NFSB'] <- "OP"
vparty$v2pashname_fix[vparty$country_name == 'Bulgaria' & vparty$v2pashname == 'ODS' & (vparty$year == 1997 | vparty$year == 2001)] <- "SDS"
vparty$v2panaallian_fix[vparty$country_name == 'Bulgaria' & vparty$v2pashname == 'ODS' & (vparty$year == 1997 | vparty$year == 2001)] <- "ODS"
# Croatia
vparty$v2panaallian_fix[vparty$country_name == 'Croatia' & vparty$v2panaallian == 'SDP/IDS/LS/Libra'] <- "SDP-LP-IDA"
vparty$v2panaallian_fix[vparty$country_name == 'Croatia' & vparty$v2panaallian == 'Kukuriku coalition'] <- "KUKURIKU"
vparty$v2pashname_fix[vparty$country_name == 'Croatia' & vparty$v2panaallian == "People's Coalition" & vparty$year == 2016] <- "SDP"
vparty$v2pashname_fix[vparty$country_name == 'Croatia' & vparty$v2pashname == 'HDZ Coalition'] <- "HDZ"
vparty$v2pashname_fix[vparty$country_name == 'Croatia' & vparty$v2pashname == 'Most'] <- "BIL"
# Czech Republic
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'TOP09' & vparty$year <= 2012] <- "TOP"
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'TOP09' & vparty$year == 2013] <- "TOP 09"
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'ODS' & vparty$year <= 2005] <- "ODS/KDS"
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'KSCM' & vparty$year < 1996] <- "KSCM/Left Block"
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'KSCM' & vparty$year >= 1996 & vparty$year < 2006] <- "Communist"
vparty$v2panaallian_fix[vparty$country_name == 'Czech Republic' & vparty$v2panaallian == 'Coalition (Koalice)'] <- "Coalition"
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'OF'] <- "Civic F."
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'HSD/SMS'] <- "MV"
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'Pi'] <- "PPEU" # Pirate
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'ANO'] <- "ANO 2011"
vparty$v2pashname_fix[vparty$country_name == 'Czech Republic' & vparty$v2pashname == 'KDU/CSL' & vparty$year != 1996] <- "KDU-CSL"
# Denmark
vparty$v2pashname_fix[vparty$country_name == 'Denmark' & vparty$v2pashname == 'DF' & (vparty$year == 2007 | vparty$year == 2015)] <- "DFP"
# Estonia
vparty$v2pashname_fix[vparty$country_name == 'Estonia' & vparty$v2pashname == 'ERe'] <- "RE"
vparty$v2pashname_fix[vparty$country_name == 'Estonia' & vparty$v2pashname == 'UVE/RP'] <- "RP"
vparty$v2pashname_fix[vparty$country_name == 'Estonia' & vparty$v2pashname == 'I'] <- "IL"
vparty$v2pashname_fix[vparty$country_name == 'Estonia' & vparty$v2pashname == 'SDE-M' & vparty$year <= 1999] <- "Moderates"
vparty$v2pashname_fix[vparty$country_name == 'Estonia' & vparty$v2pashname == 'SDE-M' & vparty$year >= 2000] <- "SDE"
vparty$v2panaallian_fix[vparty$country_name == 'Estonia' & vparty$v2pashname == 'RKI' & vparty$year == 1992] <- "IL"
# Finland
vparty$v2pashname_fix[vparty$country_name == 'Finland' & vparty$v2pashname == 'SP / P'] <- "PS" # True Finns
vparty$v2pashname_fix[vparty$country_name == 'Finland' & vparty$v2pashname == 'VIHR'] <- "VL" 
vparty$v2pashname_fix[vparty$country_name == 'Finland' & vparty$v2pashname == 'VAS'] <- "Vas" 
vparty$v2pashname_fix[vparty$country_name == 'Finland' & vparty$v2pashname == 'SSDP' & vparty$year == 2019] <- "SSPD" 
# Iceland
vparty$v2pashname_fix[vparty$country_name == 'Iceland' & vparty$v2pashname == 'Sj'] <- "IP" # Independence
vparty$v2pashname_fix[vparty$country_name == 'Iceland' & vparty$v2pashname == 'Graen'] <- "VGF"
vparty$v2pashname_fix[vparty$country_name == 'Iceland' & vparty$v2pashname == 'F'] <- "PP"
vparty$v2pashname_fix[vparty$country_name == 'Iceland' & vparty$v2pashname == 'Ab'] <- "People's Alliance"
vparty$v2pashname_fix[vparty$country_name == 'Iceland' & vparty$v2pashname == 'A'] <- "SDP"
vparty$v2pashname_fix[vparty$country_name == 'Iceland' & vparty$v2pashname == 'Sam'] <- "The Alliance"
# Israel
vparty$v2pashname_fix[vparty$country_name == 'Israel' & vparty$v2pashname == 'SHAS'] <- "Shas" 
vparty$v2pashname_fix[vparty$country_name == 'Israel' & vparty$v2pashname == 'A' & vparty$year >= 1984] <- "Labour" # Labour Alignment
vparty$v2pashname_fix[vparty$country_name == 'Israel' & vparty$v2pashname == 'A' & vparty$year == 1977] <- "Labour-M" # Labour Alignment
vparty$v2pashname_fix[vparty$country_name == 'Israel' & vparty$v2pashname == 'A' & vparty$year == 1981] <- "Labour-Align" # Labour Alignment
vparty$v2panaallian_fix[vparty$country_name == 'Israel' & vparty$v2pashname == 'A' & vparty$year == 2015] <- "Zionist Union"
vparty$v2pashname_fix[vparty$country_name == 'Israel' & vparty$v2pashname == 'L'] <- "Likud"
vparty$v2pashname_fix[vparty$country_name == 'Israel' & vparty$v2pashname == 'L' & vparty$year == 2009] <- "Likud-Ahi"
# Luxembourg
vparty$v2pashname_fix[vparty$country_name == 'Luxembourg' & vparty$v2pashname == 'LSAP'] <- "POSL" 
vparty$v2pashname_fix[vparty$country_name == 'Luxembourg' & vparty$v2pashname == 'CSV'] <- "PCS"
vparty$v2pashname_fix[vparty$country_name == 'Luxembourg' & vparty$v2pashname == 'Greng/GAP' & vparty$year >= 1994] <- "Green"
# North Macedonia 
vparty$v2pashname_fix[vparty$country_name == 'North Macedonia' & vparty$v2pashname == 'Social Democ...'] <- "SDSM"
vparty$v2panaallian_fix[vparty$country_name == 'North Macedonia' & vparty$v2pashname == 'SM' & vparty$year == 1994] <- "SDSM"
vparty$v2pashname_fix[vparty$country_name == 'North Macedonia' & vparty$v2pashname == 'SDSM' & vparty$year >= 2008 & vparty$year <= 2011] <- "Sonce"
vparty$v2panaallian_fix[vparty$country_name == 'North Macedonia' & vparty$v2pashname == 'SDSM' & (vparty$year == 2002 | vparty$year == 2006)] <- "Together for Macedonia"
vparty$v2panaallian_fix[vparty$country_name == 'North Macedonia' & vparty$v2pashname == 'SDSM' & (vparty$year == 2011)] <- "SDAM"
vparty$v2panaallian_fix[vparty$country_name == 'North Macedonia' & vparty$v2pashname == 'VMRO-DPMNE' & (vparty$year == 2002)] <- "VMRO-DPMNE-LPM"
vparty$v2panaallian_fix[vparty$country_name == 'North Macedonia' & vparty$v2pashname == 'VMRO-DPMNE' & (vparty$year == 2008)] <- "KzPM" # Coalition for a Better Macedonia
# Norway
vparty$v2pashname_fix[vparty$country_name == 'Norway' & vparty$v2pashname == 'Fr'] <- "Frp" 
vparty$v2pashname_fix[vparty$country_name == 'Norway' & vparty$v2pashname == 'Sp/Bp'] <- "SP"
vparty$v2pashname_fix[vparty$country_name == 'Norway' & vparty$v2pashname == 'Sp/Bp' & vparty$year == 2013] <- "Sp"
# Romania
vparty$v2pashname_fix[vparty$country_name == 'Romania' & vparty$v2pashname == 'PSD' & vparty$year <= 1995] <- "FSND"
vparty$v2pashname_fix[vparty$country_name == 'Romania' & vparty$v2pashname == 'PSD' & vparty$year >= 1996 & vparty$year < 2001] <- "PSDR"
vparty$v2pashname_fix[vparty$country_name == 'Romania' & vparty$v2pashname == 'PRM' & vparty$year >= 2000] <- "GRP"
vparty$v2panaallian_fix[vparty$country_name == 'Romania' & vparty$v2panaallian == 'Alliance PSD+PC'] <- "PSD-PC"
vparty$v2pashname_fix[vparty$country_name == 'Romania' & vparty$v2pashname == 'PD' & vparty$year >= 1992 & vparty$year <= 1995] <- "PD-FSN"
vparty$v2pashname_fix[vparty$country_name == 'Romania' & vparty$v2pashname == 'UDMR / DAHR /  RMDSZ' & vparty$year == 2004] <- "UDMR"
# Slovakia
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'Smer'] <- 'Smer-SD'
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'KDH' & vparty$year <= 1995] <- "MK"
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'Smer' & vparty$year <= 2006] <- "Direction"
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'SMK-MKP'] <- "SMK"
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'HZDS' & (vparty$year == 1998|vparty$year == 2002)] <- "MDS"
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'HZDS' & vparty$year == 1994] <- "HZDS/RSS"
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'HZDS' & vparty$year == 2006] <- "LS-HZDS"
vparty$v2pashname_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'SDKU-DS' & vparty$year == 2002] <- "SDKU"
vparty$v2panaallian_fix[vparty$country_name == 'Slovakia' & vparty$v2pashname == 'SDKU-DS' & vparty$year == 2002] <- "SDKU-DS"
# Slovenia
vparty$v2pashname_fix[vparty$country_name == 'Slovenia' & vparty$v2pashname == 'SD / ZLSD' & vparty$year <= 1995] <- "ZL"
vparty$v2pashname_fix[vparty$country_name == 'Slovenia' & vparty$v2pashname == 'SD / ZLSD' & vparty$year > 1995 & vparty$year <= 2007] <- "ZLSD"
vparty$v2pashname_fix[vparty$country_name == 'Slovenia' & vparty$v2pashname == 'SD / ZLSD' & vparty$year >= 2008] <- "SD"
vparty$v2pashname_fix[vparty$country_name == 'Slovenia' & vparty$v2pashname == 'NSi'] <- "NSI"
vparty$v2pashname_fix[vparty$country_name == 'Slovenia' & vparty$v2pashname == 'LZJPS'] <- "PS"
# Suriname
vparty$v2pashname_fix[vparty$country_name == 'Suriname' & vparty$v2pashname == 'NFDD'] <- "NF"
vparty$v2panaallian_fix[vparty$country_name == 'Suriname' & vparty$v2pashname == 'NFDD'] <- "NPS"
# Lithuania
vparty$v2pashname_fix[vparty$country_name == 'Lithuania' & vparty$v2pashname == 'NS'] <- "NU-SL"
vparty$v2panaallian_fix[vparty$country_name == 'Lithuania' & vparty$v2pashname == 'TS-LKD'] <- "TS"
# Mali
vparty$v2pashname_fix[vparty$country_name == 'Mali' & vparty$v2pashname == 'ADEMA-PASJ'] <- "Adema"
vparty$v2pashname_fix[vparty$country_name == 'Mali' & vparty$v2pashname == 'ADEMA-PASJ' & vparty$year >= 2013] <- "Adema/PASJ"
# Vanuatu
vparty$v2pashname_fix[vparty$country_name == 'Vanuatu' & vparty$v2pashname == 'UPM'] <- "UMP"
# Guinea-Bissau
vparty$v2pashname_fix[vparty$country_name == 'Guinea-Bissau' & vparty$v2pashname == 'RGB'] <- "RGB-MB"
# Armenia
vparty$v2pashname_fix[vparty$country_name == 'Armenia' & vparty$v2pashname == 'BHK'] <- "BH"
# Timor-Leste
vparty$v2pashname_fix[vparty$country_name == 'Timor-Leste' & vparty$v2pashname == 'FRTLI'] <- "Fretilin"
# Comoros
vparty$v2pashname_fix[vparty$country_name == 'Comoros' & vparty$v2pashname == 'BM'] <- "Mouvance Presidentielle"
# Papua New Guinea
vparty$v2pashname_fix[vparty$country_name == 'Papua New Guinea' & vparty$v2pashname == 'PP/PNUP' & vparty$year <= 2002] <- "Pangu"
# Sri Lanka
vparty$v2pashname_fix[vparty$country_name == 'Sri Lanka' & vparty$v2pashname == 'United Natio...'] <- "UNP"
# Solomon Islands
vparty$v2pashname_fix[vparty$country_name == 'Solomon Islands' & vparty$v2pashname == 'NURPP'] <- "GNUR"

# All, independence
vparty$v2pashname_fix[vparty$v2pashname == 'indep'] <- "independent"


```




```{r id government and opposition parties}

### Identify parties using matching

# create variables
vparty$exec_party <- NA
vparty$gov_party <- NA
vparty$opp_party <- NA

# identify legislative parties, government
vparty$gov_party[vparty$v2pashname_fix == vparty$gov1me | vparty$v2pashname_fix == vparty$gov2me | vparty$v2pashname_fix == vparty$gov3me] <- 1
# identify parties, opposition parties = 0
vparty$gov_party[vparty$v2pashname_fix == vparty$opp1me | vparty$v2pashname_fix == vparty$opp2me | vparty$v2pashname_fix == vparty$opp3me] <- 0
# identify parties, alliance = 1
vparty$gov_party[vparty$v2panaallian_fix == vparty$gov1me | vparty$v2panaallian_fix == vparty$gov2me | vparty$v2panaallian_fix == vparty$gov3me] <- 1
# identify parties, alliance = 1
vparty$gov_party[vparty$v2panaallian_fix == vparty$opp1me | vparty$v2panaallian_fix == vparty$opp2me | vparty$v2panaallian_fix == vparty$opp3me] <- 0

# identify legislative parties, opposition
vparty$opp_party[vparty$v2pashname_fix == vparty$gov1me | vparty$v2pashname_fix == vparty$gov2me | vparty$v2pashname_fix == vparty$gov3me] <- 0
# identify parties, opposition parties = 0
vparty$opp_party[vparty$v2pashname_fix == vparty$opp1me | vparty$v2pashname_fix == vparty$opp2me | vparty$v2pashname_fix == vparty$opp3me] <- 1
# identify parties, alliance = 1
vparty$opp_party[vparty$v2panaallian_fix == vparty$gov1me | vparty$v2panaallian_fix == vparty$gov2me | vparty$v2panaallian_fix == vparty$gov3me] <- 0
# identify parties, alliance = 1
vparty$opp_party[vparty$v2panaallian_fix == vparty$opp1me | vparty$v2panaallian_fix == vparty$opp2me | vparty$v2panaallian_fix == vparty$opp3me] <- 1

## identify non/presidential parties
# in all systems
# if execme does not match any party or alliance name, then assign exec_party = 0
vparty$exec_party[(vparty$v2pashname_fix != vparty$execme & vparty$v2pashname != vparty$execme & vparty$v2panaallian_fix != vparty$execme & vparty$v2panaallian != vparty$execme) & !is.na(vparty$opp_party)] <- 0 # check original party & alliance name
# if exec is independent and name does not match (remains NA until this point), then assign exec_party = 0
#vparty$exec_party[vparty$execme == "independent" & is.na(vparty$exec_party)] <- 0
## identify presidential parties
# if execme matches any party or alliance name, then assign exec_party = 0
vparty$exec_party[vparty$v2pashname_fix == vparty$execme | vparty$v2pashname == vparty$execme | vparty$v2panaallian_fix == vparty$execme | vparty$v2panaallian == vparty$execme] <- 1 # check original party & alliance name
# Parliamentary systems
vparty$exec_party[vparty$system == "Parliamentary" & (vparty$v2pashname_fix == vparty$gov1me | vparty$v2pashname == vparty$gov1me | vparty$v2panaallian_fix == vparty$gov1me | vparty$v2panaallian == vparty$gov1me) & !is.na(vparty$opp_party) & is.na(vparty$exec_party)] <- 1
# if exec is independent and name does not match (remains NA until this point), then assign exec_party = 0
vparty$exec_party[vparty$execme == "independent" & is.na(vparty$exec_party)] <- 0

# Manual fix
# Indonesia
vparty$gov_party[vparty$country_name == 'Indonesia' & vparty$v2pashname == 'Nasdem' & vparty$year >= 2014 & vparty$year <= 2019] <- 1
vparty$opp_party[vparty$country_name == 'Indonesia' & vparty$v2pashname == 'Nasdem' & vparty$year >= 2014 & vparty$year <= 2019] <- 0
# Belgium
vparty$gov_party[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PVV-OVLD' & vparty$year == 2007] <- 1
vparty$opp_party[vparty$country_name == 'Belgium' & vparty$v2pashname == 'PVV-OVLD' & vparty$year == 2007] <- 0



vparty.exec <- subset(vparty, year >= 1976 & year <= 2015 & ((system == "Presidential" & v2paseatshare >= 30.0) | (system != "Presidential" & v2paseatshare >= 15.0)) & boix_democracy == 1) # 
vparty.exec.na <- subset(vparty.exec, is.na(exec_party) & !is.na(execme))
summary(vparty.exec$exec_party) # 42

```

```{r after check assign gov}

### Identify gov and opp parties using inference

# when only one party/coalition in power (no gov2 or gov3)
# inductively assign gov_party = 0 after review, as long as seat share < 15.0% and numvote is not 0.
vparty$gov_party[is.na(vparty$gov_party) & vparty$v2paseatshare <= 15 & vparty$v2paseatshare >= 5.0 & vparty$numvote != 0 & !is.na(vparty$v2xpa_antiplural) & !(vparty$country_name %in% c("Kosovo","Palestine/West Bank","Somaliland","Hong Kong","Montenegro","Sao Tome and Principe","Serbia","Seychelles","Zanzibar")) & vparty$boix_democracy == 1 & is.na(vparty$gov2me) & is.na(vparty$gov3me)] <- 0
# same for opposition
vparty$opp_party[is.na(vparty$gov_party) & vparty$v2paseatshare <= 15 & vparty$v2paseatshare >= 5.0 & vparty$numvote != 0 & !is.na(vparty$v2xpa_antiplural) & !(vparty$country_name %in% c("Kosovo","Palestine/West Bank","Somaliland","Hong Kong","Montenegro","Sao Tome and Principe","Serbia","Seychelles","Zanzibar")) & vparty$boix_democracy == 1 & is.na(vparty$gov2me) & is.na(vparty$gov3me)] <- 1

# If gov_party and opp_party remain unassigned AND v2pavote is less than the smallest gov party's vote (opp3vote), then assign gov_party = 0, opp_party = 1.
vparty$opp_party[(is.na(vparty$gov_party)|is.na(vparty$opp_party)) & (vparty$v2pavote <= vparty$gov3vote)] <- 1
vparty$gov_party[(is.na(vparty$gov_party)|is.na(vparty$opp_party)) & (vparty$v2pavote <= vparty$gov3vote)] <- 0

# If opp_party remains unassigned and gov_party = 0, then assign opp_party = 1.
vparty$opp_party[is.na(vparty$opp_party) & vparty$gov_party == 0] <- 1

```

```{r after check assign pres}

### Identify pres parties using inference

# If pres remains NA and gov_party or opp_party is assigned, then assign exec_party = 0.
vparty$exec_party[is.na(vparty$exec_party) & (!is.na(vparty$gov_party)|!is.na(vparty$opp_party)) & !(vparty$country_name %in% c("Kosovo","Palestine/West Bank","Somaliland","Hong Kong","Montenegro","Sao Tome and Principe","Serbia","Seychelles","Zanzibar")) & vparty$boix_democracy == 1] <- 0

```

```{r check merge}

# check merge, states/systems
vparty.dpi.check <- subset(vparty, year >= 1976 & year <= 2020 & is.na(system) & boix_democracy == 1)
unique(vparty.dpi.check$country_name)

# check merge, parties
vparty.dpi.check.gov <- subset(vparty, year >= 1976 & year <= 2020 & v2paseatshare >= 5.0 & (is.na(gov_party)  | is.na(opp_party)) & (v2pavote >= gov2vote) & !is.na(v2xpa_antiplural) & !(country_name %in% c("Kosovo","Palestine/West Bank","Somaliland","Hong Kong","Montenegro","Sao Tome and Principe","Serbia","Seychelles","Zanzibar")) & boix_democracy == 1 & frac <= 1 & numvote > 0)
unique(vparty.dpi.check.gov$country_name)

# total observations merged
vparty.dpi.check.alldata <- subset(vparty, year >= 1976 & year <= 2020 & !is.na(v2xpa_antiplural) & !is.na(gov_party) & !(country_name %in% c("Kosovo","Palestine/West Bank","Somaliland","Hong Kong","Montenegro","Sao Tome and Principe","Serbia","Seychelles","Zanzibar")) & boix_democracy == 1 & frac <= 1)
#unique(vparty.dpi.check.alldata$country_name)

freq(vparty.dpi.check.alldata$gov_party)
freq(vparty.dpi.check.alldata$exec_party)

```

```{r check coverage}

# All parties
vparty.1975.2014 <- subset(vparty, year >= 1975 & year <= 2014 & !is.na(v2xpa_antiplural) & boix_democracy == 1)
# coded observations
vparty.1975.2014.gov <- subset(vparty, year >= 1975 & year <= 2014 & !is.na(v2xpa_antiplural) & !is.na(gov_party) & boix_democracy == 1)
# describe seat share
freq(vparty.1975.2014$gov_party)
mean(vparty.1975.2014$v2paseatshare[!is.na(vparty.1975.2014$gov_party)], na.rm = TRUE) # coded/matched observations
mean(vparty.1975.2014$v2paseatshare[is.na(vparty.1975.2014$gov_party)], na.rm = TRUE) # not coded/matched

# Low frac
vparty.1975.2014.lowfrac <- subset(vparty, year >= 1975 & year <= 2014 & !is.na(v2xpa_antiplural) & frac <= 0.9 & boix_democracy == 1)
# coded observations
vparty.1975.2014.gov.lowfrac <- subset(vparty, year >= 1975 & year <= 2014 & !is.na(v2xpa_antiplural) & !is.na(gov_party) & frac <= 0.9 & boix_democracy == 1)
# describe seat share
freq(vparty.1975.2014.lowfrac$gov_party)
mean(vparty.1975.2014.lowfrac$v2paseatshare[!is.na(vparty.1975.2014.lowfrac$gov_party)], na.rm = TRUE) # coded/matched observations
mean(vparty.1975.2014.lowfrac$v2paseatshare[is.na(vparty.1975.2014.lowfrac$gov_party)], na.rm = TRUE) # not coded/matched

# Above 5 percent seat share
vparty.1975.2014.seatshare <- subset(vparty, year >= 1975 & year <= 2014 & !is.na(v2xpa_antiplural) & v2paseatshare >= 5.0 & boix_democracy == 1)
# coded observations
vparty.1975.2014.gov.seatshare <- subset(vparty, year >= 1975 & year <= 2014 & !is.na(v2xpa_antiplural) & !is.na(gov_party) & v2paseatshare >= 5.0 & boix_democracy == 1)
# describe seat share
freq(vparty.1975.2014.seatshare$gov_party)
mean(vparty.1975.2014.seatshare$v2paseatshare[!is.na(vparty.1975.2014.seatshare$gov_party)], na.rm = TRUE) # coded/matched observations
mean(vparty.1975.2014.seatshare$v2paseatshare[is.na(vparty.1975.2014.seatshare$gov_party)], na.rm = TRUE) # not coded/matched

```



### Calculate Legislative ideology weights (using V-Party data)

```{r api weight}

# Spot fix data before calculating API weight
# Brazil
vparty$v2paseatshare[vparty$id == 'BRA 1982 PDS'] <- 43.22 # Brazil Democratic Social Party, 1982
vparty$v2paseatshare[vparty$id == 'BRA 1986 PDS'] <- 7.89 # Brazil Democratic Social Party, 1986
vparty$v2paseatshare[vparty$id == 'BRA 1990 PDS'] <- 8.91 # Brazil Democratic Social Party, 1990
# vparty$v2paseatshare[vparty$id == 'BRA 1990 PRN'] <- 8.29 # Brazil National Reconstruction Party / Christian Labour Party, 1990

print(vparty$v2xpa_antiplural[vparty$id == 'BRA 1990 PDS'] * vparty$v2paseatshare[vparty$id == 'BRA 1990 PDS'] *0.01 )


# create api_weight variable for aggregation; multiplied by 0.01 since seat share variable is in percentage ex. 20% -> 0.2
vparty$api_weight <- vparty$v2xpa_antiplural*vparty$v2paseatshare*0.01

# create popul_weight variable for aggregation; multiplied by 0.01 since seat share variable is in percentage ex. 20% -> 0.2
vparty$popul_weight <- vparty$v2xpa_popul*vparty$v2paseatshare*0.01

# create conserv_weight variable for aggregation; multiplied by 0.01 since seat share variable is in percentage ex. 20% -> 0.2
vparty$conserv_weight <- vparty$v2pariglef*vparty$v2paseatshare*0.01

# create extremism_weight variable for aggregation; multiplied by 0.01 since seat share variable is in percentage ex. 20% -> 0.2
vparty$extremism_weight <- (abs(vparty$v2pariglef))*vparty$v2paseatshare*0.01

library(ggrepel)


```

### Calculate government ideology scores (from V-Party)

Use aggregate() command by country and year, sum weighted scores.

```{r transform vparty}
### transform data, API
df1 <- aggregate(vparty$api_weight, by=list(vparty$country_name, vparty$year, vparty$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df1)[names(df1) == 'Group.1'] <- 'country_name'
names(df1)[names(df1) == 'Group.2'] <- 'year'
names(df1)[names(df1) == 'Group.3'] <- 'gov_party'
names(df1)[names(df1) == 'x'] <- 'api_gov'

# describe
#describe(df1$api_gov)

# coutry year match id
df1$cy2 <- paste(df1$country_name, df1$year)

### transform data, Populism
df2 <- aggregate(vparty$popul_weight, by=list(vparty$country_name, vparty$year, vparty$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df2)[names(df2) == 'Group.1'] <- 'country_name'
names(df2)[names(df2) == 'Group.2'] <- 'year'
names(df2)[names(df2) == 'Group.3'] <- 'gov_party'
names(df2)[names(df2) == 'x'] <- 'popul_gov'

# describe
#describe(df2$popul_gov)

# coutry year match id
df2$cy2 <- paste(df2$country_name, df2$year)


### transform data, Left Right
df2a <- aggregate(vparty$conserv_weight, by=list(vparty$country_name, vparty$year, vparty$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df2a)[names(df2a) == 'Group.1'] <- 'country_name'
names(df2a)[names(df2a) == 'Group.2'] <- 'year'
names(df2a)[names(df2a) == 'Group.3'] <- 'gov_party'
names(df2a)[names(df2a) == 'x'] <- 'conserv_gov'

# describe
#describe(df2a$conserv_gov)

# coutry year match id
df2a$cy2 <- paste(df2a$country_name, df2a$year)



### transform data, Extremism
df2b <- aggregate(vparty$extremism_weight, by=list(vparty$country_name, vparty$year, vparty$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df2b)[names(df2b) == 'Group.1'] <- 'country_name'
names(df2b)[names(df2b) == 'Group.2'] <- 'year'
names(df2b)[names(df2b) == 'Group.3'] <- 'gov_party'
names(df2b)[names(df2b) == 'x'] <- 'extremism_gov'

# describe
#describe(df2b$extremism_gov)

# coutry year match id
df2b$cy2 <- paste(df2b$country_name, df2b$year)


### transform data, seat share
df3 <- aggregate(vparty$v2paseatshare, by=list(vparty$country_name, vparty$year, vparty$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df3)[names(df3) == 'Group.1'] <- 'country_name'
names(df3)[names(df3) == 'Group.2'] <- 'year'
names(df3)[names(df3) == 'Group.3'] <- 'gov_party'
names(df3)[names(df3) == 'x'] <- 'v2paseatshare'

# describe
#describe(df3$v2paseatshare)

# coutry year match id
df3$cy2 <- paste(df3$country_name, df3$year)


### transform data, seat share
df3a <- aggregate(vparty$v2paseatshare, by=list(vparty$country_name, vparty$year), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df3a)[names(df3a) == 'Group.1'] <- 'country_name'
names(df3a)[names(df3a) == 'Group.2'] <- 'year'
names(df3a)[names(df3a) == 'x'] <- 'seatshare_total'

# describe
#describe(df3$v2paseatshare)

# coutry year match id
df3a$cy2 <- paste(df3a$country_name, df3a$year)


### transform data, seat share
df4 <- aggregate(vparty$exec_party, by=list(vparty$country_name, vparty$year), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df4)[names(df4) == 'Group.1'] <- 'country_name'
names(df4)[names(df4) == 'Group.2'] <- 'year'
names(df4)[names(df4) == 'x'] <- 'exec_party'

# describe
#describe(df3$v2paseatshare)

# coutry year match id
df4$cy2 <- paste(df4$country_name, df4$year)

### transform data, anti-pluralism
df4a <- aggregate(vparty$v2xpa_antiplural, by=list(vparty$country_name, vparty$year, vparty$exec_party), FUN=mean, na.rm=TRUE, na.action=NULL)

# rename columns
names(df4a)[names(df4a) == 'Group.1'] <- 'country_name'
names(df4a)[names(df4a) == 'Group.2'] <- 'year'
names(df4a)[names(df4a) == 'Group.3'] <- 'exec_party'
names(df4a)[names(df4a) == 'x'] <- 'api_exec_party'

# describe
#describe(df3$v2paseatshare)

# coutry year match id
df4a$cy2 <- paste(df4a$country_name, df4a$year)

### transform data, populism
df4b <- aggregate(vparty$v2xpa_popul, by=list(vparty$country_name, vparty$year, vparty$exec_party), FUN=mean, na.rm=TRUE, na.action=NULL)

# rename columns
names(df4b)[names(df4b) == 'Group.1'] <- 'country_name'
names(df4b)[names(df4b) == 'Group.2'] <- 'year'
names(df4b)[names(df4b) == 'Group.3'] <- 'exec_party'
names(df4b)[names(df4b) == 'x'] <- 'popul_exec_party'

# describe
#describe(df3$v2paseatshare)

# coutry year match id
df4b$cy2 <- paste(df4b$country_name, df4b$year)

### transform data, left right
df4c <- aggregate(vparty$v2pariglef, by=list(vparty$country_name, vparty$year, vparty$exec_party), FUN=mean, na.rm=TRUE, na.action=NULL)

# rename columns
names(df4c)[names(df4c) == 'Group.1'] <- 'country_name'
names(df4c)[names(df4c) == 'Group.2'] <- 'year'
names(df4c)[names(df4c) == 'Group.3'] <- 'exec_party'
names(df4c)[names(df4c) == 'x'] <- 'conserv_exec_party'

# describe
#describe(df3$v2paseatshare)

# coutry year match id
df4c$cy2 <- paste(df4c$country_name, df4c$year)

# create exec_party = 1 only subsets
df4a <- subset(df4a, exec_party == 1)
df4b <- subset(df4b, exec_party == 1)
df4c <- subset(df4c, exec_party == 1)

```

### Combine scores into one dataset

```{r populate country level data}

# V-Party
# Government parties
# popul_gov, df2
df1$popul_gov[df1$gov_party == 1] <- df2$popul_gov[match(df1$cy2, df2$cy2) & df2$gov_party == 1]
# conserv_gov, df2a
df1$conserv_gov[df1$gov_party == 1] <- df2a$conserv_gov[match(df1$cy2, df2a$cy2) & df2a$gov_party == 1]
# extremism_gov, df2b
df1$extremism_gov[df1$gov_party == 1] <- df2b$extremism_gov[match(df1$cy2, df2b$cy2) & df2b$gov_party == 1]
# seatshare, df3
df1$seatshare_gov[df1$gov_party == 1] <- df3$v2paseatshare[match(df1$cy2, df3$cy2) & df3$gov_party == 1]
# seatshare total, df3
df1$seatshare_total <- df3a$seatshare_total[match(df1$cy2, df3a$cy2)]
# api_exec_party, df4a
df1$api_exec_party <- df4a$api_exec_party[match(df1$cy2, df4a$cy2)]
# popul_pres, df4b
df1$popul_exec_party <- df4b$popul_exec_party[match(df1$cy2, df4b$cy2)]
# conserv_pres, df2c
df1$conserv_exec_party <- df4c$conserv_exec_party[match(df1$cy2, df4c$cy2)]

# Opposition parties
# popul_gov, df2
df1$popul_gov[df1$gov_party == 0] <- df2$popul_gov[match(df1$cy2, df2$cy2) & df2$gov_party == 0]
# conserv_gov, df2a
df1$conserv_gov[df1$gov_party == 0] <- df2a$conserv_gov[match(df1$cy2, df2a$cy2) & df2a$gov_party == 0]
# extremism_gov, df2b
df1$extremism_gov[df1$gov_party == 0] <- df2b$extremism_gov[match(df1$cy2, df2b$cy2) & df2b$gov_party == 0]
# seatshare, df3
df1$seatshare_gov[df1$gov_party == 0] <- df3$v2paseatshare[match(df1$cy2, df3$cy2) & df3$gov_party == 0]
```

```{r merge and subset}

## V-party
# cy and cy2
df1$cy <- vparty$cy[match(df1$cy2, vparty$cy2)]

## Boix, Miller, Rosato
# Democracy
df1$boix_democracy <- boix2013$democracy[match(df1$cy, boix2013$cy)]
summary(df1$boix_democracy) #n=7281, 918 NA

#df1 <- subset(df1, !(api_gov == 0.0 & popul_gov == 0.0 & conserv_gov == 0.0))

# subset usable data by government/opposition
df.gov_scores <- subset(df1, gov_party == 1)
df.opp_scores <- subset(df1, gov_party == 0)

```




## Load Judicial Independence Data (Linzer and Staton 2015)

Staton, Jeffrey; Linzer, Drew; Reenock, Christopher; Holsinger, Jordan, 2019, "Update, A Global Measure of Judicial Independence, 1900-2015", https://doi.org/10.7910/DVN/NFXWUO, Harvard Dataverse, V1.

Available as RData file at: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/NFXWUO.

```{r LJI data}
### Load data -----------------------------------------

## Load independence data
load("~/Desktop/PhD Program/Spring 2024/Large N Judicial Independence Paper/Data/Linzer_Staton/LJI-estimates-20170321.Rdata")
linzerstaton_orig <- x

## Load independence data
load("~/Desktop/PhD Program/Spring 2024/Large N Judicial Independence Paper/Data/Linzer_Staton/LJI-estimates-20181210[includesVdem].Rdata")
linzerstaton <- x

# create country-year identifier (country+year)
linzerstaton$cy <- paste(linzerstaton$country, linzerstaton$year)
# create country-year identifier (country+year), long
linzerstaton_orig$cy <- paste(linzerstaton_orig$country, linzerstaton_orig$year)

# Country corrections
linzerstaton$country_fix <- linzerstaton$country
linzerstaton$country_fix[linzerstaton$country == 'Gambia'] <- 'The Gambia'
linzerstaton$country_fix[linzerstaton$country == 'Myanmar'] <- 'Burma/Myanmar'
linzerstaton$country_fix[linzerstaton$country == 'Macedonia'] <- 'North Macedonia'
linzerstaton$country_fix[linzerstaton$country == 'Congo'] <- 'Republic of the Congo'
linzerstaton$country_fix[linzerstaton$country == 'East Timor'] <- 'Timor-Leste'
linzerstaton$country_fix[linzerstaton$country == 'Germany' & linzerstaton$year <= 1988] <- 'Germany Alt.'
linzerstaton$country_fix[linzerstaton$country == 'German Federal Republic' & linzerstaton$year <= 1988] <- 'Germany'

### Rename LJI variables

linzerstaton$LJI_vdem <- linzerstaton$LJI

#### Match

# Match Vdem and Linzer Staton
# LJI
linzerstaton$LJI <- linzerstaton_orig$LJI[match(linzerstaton$cy, linzerstaton_orig$cy)]

# Summarize years
summary(linzerstaton$year) # 1900 min, max 2015

# new lagged LJI variable

# Lag variable using fixest package: https://lrberge.github.io/fixest/reference/lag.formula.html
library(fixest)
linzerstaton$LJI_lag3 <- lag_fml(LJI ~ country + year, k = -3, linzerstaton)
linzerstaton$LJI_lag2 <- lag_fml(LJI ~ country + year, k = -2, linzerstaton)
linzerstaton$LJI_lag1 <- lag_fml(LJI ~ country + year, k = -1, linzerstaton)
linzerstaton$LJI_lead1 <- lag_fml(LJI ~ country + year, k = 1, linzerstaton)
linzerstaton$LJI_lead2 <- lag_fml(LJI ~ country + year, k = 2, linzerstaton)
# vdem
linzerstaton$LJI_vdem_lag3 <- lag_fml(LJI_vdem ~ country + year, k = -3, linzerstaton)
linzerstaton$LJI_vdem_lag2 <- lag_fml(LJI_vdem ~ country + year, k = -2, linzerstaton)
linzerstaton$LJI_vdem_lag1 <- lag_fml(LJI_vdem ~ country + year, k = -1, linzerstaton)
linzerstaton$LJI_vdem_lead1 <- lag_fml(LJI_vdem ~ country + year, k = 1, linzerstaton)
linzerstaton$LJI_vdem_lead2 <- lag_fml(LJI_vdem ~ country + year, k = 2, linzerstaton)

# create country-year identifier (country+year)
linzerstaton$cy <- paste(linzerstaton$state_abb, linzerstaton$year)
# create country-year identifier (country+year), long
linzerstaton$cy2 <- paste(linzerstaton$country_fix, linzerstaton$year)

```


## Load Political Constraints (Competition) Data (Henisz 2002)

Henisz, W. J. (2002). "The Institutional Environment for Infrastructure Investment." Industrial
and Corporate Change 11(2): Forthcoming.

Available as Excel file at: https://mgmt.wharton.upenn.edu/faculty/heniszpolcon/polcondataset/

```{r Henisz data}
### Load data -----------------------------------------

## Load independence data
polcon <- read.csv("~/Desktop/PhD Program/Fall 2024/Quantitative Model/POLCON_2021_VDEM.csv")

# Rename countries abbreviations
polcon$polity_country_fix <- polcon$polity_country
polcon$polity_country_fix[polcon$ctrynm == 'MLT'] <- 'Malta' # Malta
polcon$polity_country_fix[polcon$ctrynm == 'SLV'] <- 'Slovenia'
polcon$polity_country_fix[polcon$polity_country == 'Germany West'] <- 'Germany'
polcon$polity_country_fix[polcon$polity_country == 'United States'] <- 'United States of America'
polcon$polity_country_fix[polcon$cnts_country == 'SURINAME'] <- 'Suriname'
polcon$polity_country_fix[polcon$polity_country == 'Czechoslovakia'] <- 'Czech Republic'
polcon$polity_country_fix[polcon$polity_country == 'Myanmar (Burma)'] <- 'Burma/Myanmar'
polcon$polity_country_fix[polcon$polity_country == 'USSR' & polcon$year <= 1989] <- 'Russia'
polcon$polity_country_fix[polcon$polity_country == 'Korea, South'] <- 'South Korea'
polcon$polity_country_fix[polcon$polity_country == 'Korea, North'] <- 'North Korea'
polcon$polity_country_fix[polcon$polity_country == 'EAST TIMOR'] <- 'Timor-Leste'
polcon$polity_country_fix[polcon$polity_country == 'KOSOVO'] <- 'Kosovo'
polcon$polity_country_fix[polcon$cnts_country == 'C VERDE IS'] <- 'Cape Verde'
polcon$polity_country_fix[polcon$polity_country == 'Cen African Rep'] <- 'Central African Republic'
polcon$polity_country_fix[polcon$cnts_country == 'MALDIVE IS'] <- 'Maldives'
polcon$polity_country_fix[polcon$cnts_country == 'C VERDE IS'] <- 'Cape Verde'
polcon$polity_country_fix[polcon$polity_country == 'Congo, Kinshasa'] <- 'Democratic Republic of the Congo'
polcon$polity_country_fix[polcon$polity_country == 'Congo, Brazzaville'] <- 'Republic of the Congo'
polcon$polity_country_fix[polcon$polity_country == 'Dominican Rep'] <- 'Dominican Republic'
polcon$polity_country_fix[polcon$polity_country == 'Gambia'] <- 'The Gambia'
polcon$polity_country_fix[polcon$polity_country == 'Trinidad'] <- 'Trinidad and Tobago'
polcon$polity_country_fix[polcon$polity_country == 'Germany East'] <- 'German Democratic Republic'
polcon$polity_country_fix[polcon$polity_country == 'Trinidad'] <- 'Trinidad and Tobago'
polcon$polity_country_fix[polcon$cnts_country == 'BARBADOS'] <- 'Barbados'
polcon$polity_country_fix[polcon$polity_country == 'Bosnia'] <- 'Bosnia and Herzegovina'
polcon$polity_country_fix[polcon$polity_country == 'Macedonia'] <- 'North Macedonia'
polcon$polity_country_fix[polcon$cnts_country == 'MONTENEGRO'] <- 'Montenegro'
polcon$polity_country_fix[polcon$cnts_country == 'VANUATU'] <- 'Vanuatu'
polcon$polity_country_fix[polcon$polity_country == 'UAE'] <- 'United Arab Emirates'
polcon$polity_country_fix[polcon$cnts_country == 'SOLOMON IS'] <- 'Solomon Islands'
polcon$polity_country_fix[polcon$cnts_country == 'SEYCHELLSS'] <- 'Seychelles'
polcon$polity_country_fix[polcon$cnts_country == 'SAO TOME/PR'] <- 'Sao Tome and Principe'
polcon$polity_country_fix[polcon$cnts_country == 'MONTENEGRO'] <- 'Montenegro'
polcon$polity_country_fix[polcon$cnts_country == 'SAO TOMEEPR'] <- 'Sao Tome and Principe'


# create country-year identifier (country+year)
polcon$cy <- paste(polcon$ctrynm, polcon$year)
# create country-year identifier (country+year), long
polcon$cy2 <- paste(polcon$polity_country_fix, polcon$year)
# Count countries
unique(polcon$polity_country_fix)

# PolConiii variable
# summary of judicial independence and year variables (xconst, year)
summary(polcon$polconiii) # 1378 NAs
summary(polcon$POLCONIII_VDEM) # 224 NAs
# View years
summary(polcon$year) # min 1800 max 2021


```


# Cabinet data

### Load Parlgov cabinet data

```{r parlgov cabinet}
###############################################

cabinets <- read.csv("/Users/alice/Desktop/PhD Program/Summer 2024/EITM/Model/parlgov/parlgov-cabinet.csv")

class(cabinets$election_year)
summary(cabinets$cabinet_party) # no missing, 31.8% cabinet parties

# create variable that matches party abbrev. from v-party data (v2pashname)
cabinets$seat_share <- (cabinets$seats / cabinets$election_seats_total)

# create variable that matches party abbrev. from v-party data (v2pashname)
cabinets$v2pashname <- cabinets$party_name_short

```

### Fix party names

```{r parl party names}

# reconcile different party abbreviations
cabinets$v2pashname[cabinets$country_name == 'Australia' & cabinets$v2pashname == 'NCP|NPA'] <- 'ACP-NPA' # Australian Country Party / National Party
cabinets$v2pashname[cabinets$country_name == 'Austria' & cabinets$v2pashname == 'Gruene'] <- 'GRUENE'
# Belgium
cabinets$v2pashname[cabinets$country_name == 'Belgium' & cabinets$v2pashname == 'CVP|CD&V'] <- 'CVP' # Christian People's
cabinets$v2pashname[cabinets$country_name == 'Belgium' & cabinets$v2pashname == 'PSC-CDH'] <- 'PSC' # Christian democratic/Humanist
cabinets$v2pashname[cabinets$country_name == 'Belgium' & cabinets$v2pashname == 'PVV|VLD'] <- 'PVV-OVLD'
cabinets$v2pashname[cabinets$country_name == 'Belgium' & cabinets$v2pashname == 'SP'] <- 'SPA' #Socialist party differently
cabinets$v2pashname[cabinets$country_name == 'Belgium' & cabinets$v2pashname == 'SPa+Spi'] <- 'SPA/Spirit' #Socialist-Spirit
cabinets$v2pashname[cabinets$country_name == 'Belgium' & cabinets$v2pashname == 'CD+NVA'] <- 'CD&V/N-VA' #Christian-Democrat and Flemish / New Flemish Alliance
# Bulgaria
cabinets$v2pashname[cabinets$country_name == 'Bulgaria' & cabinets$v2pashname == 'SK'] <- 'BC' # Blue Coalition
cabinets$v2pashname[cabinets$country_name == 'Bulgaria' & cabinets$v2pashname == 'KzB|DL'] <- 'KzB/BSP' #Coalition for Bulgaria | Democratic Left
cabinets$v2pashname[cabinets$country_name == 'Bulgaria' & cabinets$v2pashname == 'DSB|DB'] <- 'DSB' #Democrats for a Strong Bulgaria
cabinets$v2pashname[cabinets$country_name == 'Bulgaria' & cabinets$v2pashname == 'BE'] <- 'BEL' #Bulgarian Euro-Left Coalition
cabinets$v2pashname[cabinets$country_name == 'Bulgaria' & cabinets$v2pashname == 'DPS' & cabinets$election_year != 1991] <- 'ONS' #Union for National Salvation
cabinets$v2pashname[cabinets$country_name == 'Bulgaria' & cabinets$v2pashname == 'Ataka'] <- 'ATA' # National Union Attack / Attack

# Canada
cabinets$v2pashname[cabinets$country_name == 'Canada' & cabinets$v2pashname == 'CCF|NDP'] <- 'NDP' #Co-operative Commonwealth Federation | New Democratic Party

# Switzerland
cabinets$v2pashname[cabinets$country_name == 'Switzerland' & cabinets$v2pashname == 'SP-PS'] <- 'SP' #Social Democratic Party of Switzerland
cabinets$v2pashname[cabinets$country_name == 'Switzerland' & cabinets$v2pashname == 'FDP-PRD'] <- 'FDP' #Radical Democratic Party
cabinets$v2pashname[cabinets$country_name == 'Switzerland' & cabinets$v2pashname == 'SVP-UDC'] <- 'SVP' #Swiss People's Party

# Croatia
cabinets$v2pashname[cabinets$country_name == 'Croatia' & cabinets$v2pashname == 'HNS-LD'] <- 'HNS' #Croatian People's Party -- Liberal Democrats
cabinets$v2pashname[cabinets$country_name == 'Croatia' & cabinets$v2pashname == 'SPH'] <- 'SDP' #Social Democratic Party
cabinets$v2pashname[cabinets$country_name == 'Croatia' & cabinets$v2pashname == 'HDZ' & cabinets$election_year == 2016] <- 'HDZ Coalition' # alliance: HDZ Coalition
cabinets$v2pashname[cabinets$country_name == 'Croatia' & cabinets$v2pashname == 'HL-LR'] <- 'CL-LP' # Croatian Labourists -- Labour Party

# Czech Republic
cabinets$v2pashname[cabinets$country_name == 'Czech Republic' & cabinets$v2pashname == 'KDU-CSL'] <- 'KDU/CSL' #Christian Democratic Union -- People's Party
cabinets$v2pashname[cabinets$country_name == 'Czech Republic' & cabinets$v2pashname == 'HSD-SMS'] <- 'HSD/SMS' #Movement for Self-Gov. Dem./Moravia Salesia
cabinets$v2pashname[cabinets$country_name == 'Czech Republic' & cabinets$v2pashname == 'US'] <- 'US/DEU' #Freedom Union
cabinets$v2pashname[cabinets$country_name == 'Czech Republic' & cabinets$v2pashname == 'STAN'] <- 'SN-VA' # Mayors and Independents

# Denmark
cabinets$v2pashname[cabinets$country_name == 'Denmark' & cabinets$v2pashname == 'Sd'] <- 'SD' #	Social dems
cabinets$v2pashname[cabinets$country_name == 'Denmark' & cabinets$v2pashname == 'KrF'] <- 'KrF/KD' # Christian People's Party / Christian Democrats
cabinets$v2pashname[cabinets$country_name == 'Denmark' & cabinets$v2pashname == 'NLA'] <- 'LA' #	[New] Liberal Alliance
cabinets$v2pashname[cabinets$country_name == 'Denmark' & cabinets$v2pashname == 'En-O'] <- 'Enh' #	Red-Green Alliance

# Germany
cabinets$v2pashname[cabinets$country_name == 'Germany' & cabinets$v2pashname == 'CDU+CSU'] <- 'CDU' #	Christian Democratic Union / Christian Social Union ** note separate V-Party API values for CDU, CSU
#cabinets$v2pashname[cabinets$country_name == 'Germany' & cabinets$party_name_short == 'CDU+CSU'] <- 'CDU' #	Christian Democratic Union / Christian Social Union ** note separate V-Party API values for CDU, CSU
cabinets$v2pashname[cabinets$country_name == 'Germany' & cabinets$v2pashname == 'B90/Gru' & cabinets$election_year <= 1987] <- 'Grue' #	Alliance 90 / Greens / Grue
cabinets$v2pashname[cabinets$country_name == 'Germany' & cabinets$v2pashname == 'B90/Gru' & cabinets$election_year >= 1994] <- 'B90/Grue' #	Alliance 90 / Greens / Grue
cabinets$v2pashname[cabinets$country_name == 'Germany' & cabinets$v2pashname == 'PDS|Li' & cabinets$election_year <= 2005] <- 'PDS' #	PDS | The Left / Party for Democratic Socialism
cabinets$v2pashname[cabinets$country_name == 'Germany' & cabinets$v2pashname == 'PDS|Li' & cabinets$election_year >= 2009] <- 'Linke' #	PDS | The Left / The Left

# Spain
cabinets$v2pashname[cabinets$country_name == 'Spain' & cabinets$v2pashname == 'AP-P'] <- 'AP / PP' # People's Alliance-Party / People's Party
cabinets$v2pashname[cabinets$country_name == 'Spain' & cabinets$v2pashname == 'P'] <- 'PODEMOS' # We Can
cabinets$v2pashname[cabinets$country_name == 'Spain' & cabinets$v2pashname == 'UP'] <- 'UWC' # United We Can
cabinets$v2pashname[cabinets$country_name == 'Spain' & cabinets$v2pashname == 'PCE|IU'] <- 'PCE/IU' # Communist Party / United Left

# Estonia
cabinets$v2pashname[cabinets$country_name == 'Estonia' & cabinets$v2pashname == 'SDE|M'] <- 'SDE-M' # Social Democratic Party | Moderates
cabinets$v2pashname[cabinets$country_name == 'Estonia' & cabinets$v2pashname == 'EM'] <- 'EME' # Estonian Country Union
cabinets$v2pashname[cabinets$country_name == 'Estonia' & cabinets$v2pashname == 'ERa/EKR' & cabinets$election_year <= 2015] <- 'ERa' # People's Union of Estonia
cabinets$v2pashname[cabinets$country_name == 'Estonia' & cabinets$v2pashname == 'ERa/EKR' & cabinets$election_year >= 2019] <- 'ER' # People's Union of Estonia / Estonian People's Party
cabinets$v2pashname[cabinets$country_name == 'Estonia' & cabinets$v2pashname == 'IRL'] <- 'I' # Union of Pro Patria and Res Publica

# Finland
cabinets$v2pashname[cabinets$country_name == 'Finland' & cabinets$v2pashname == 'DL|VAS' & cabinets$election_year <= 1989] <- 'SKDL' # Democratic Union | Left Alliance / Finish People's Democratic Union
cabinets$v2pashname[cabinets$country_name == 'Finland' & cabinets$v2pashname == 'DL|VAS' & cabinets$election_year >= 1990] <- 'VAS' # Democratic Union | Left Alliance / Left Alliance
cabinets$v2pashname[cabinets$country_name == 'Finland' & cabinets$v2pashname == 'KE|SLK'] <- 'L' # National Progressive Party | [Finnish] Liberal People's Party
cabinets$v2pashname[cabinets$country_name == 'Finland' & cabinets$v2pashname == 'RKP-SFP'] <- 'RKP' # Swedish People's Party
cabinets$v2pashname[cabinets$country_name == 'Finland' & cabinets$v2pashname == 'SP|P'] <- 'SP / P' # Finnish / True Finns
cabinets$v2pashname[cabinets$country_name == 'Finland' & cabinets$party_name_short == 'SP|P' & cabinets$election_year >= 1970 & cabinets$election_year <= 1987] <- 'SMP' # Finnish Rural Party / True Finns

# France
cabinets$v2pashname[cabinets$country_name == 'France' & cabinets$v2pashname == 'IR|DL'] <- 'RI' # Independent Republicans | Liberal Democracy
cabinets$v2pashname[cabinets$country_name == 'France' & cabinets$v2pashname == 'G' & cabinets$election_year <= 1976] <- 'UDR' # Gaullists / UDR (1968-1976)
cabinets$v2pashname[cabinets$country_name == 'France' & cabinets$v2pashname == 'UDF|MD'] <- 'UDF' # Union for French Democracy | Democratic Movement
cabinets$v2pashname[cabinets$country_name == 'France' & cabinets$v2pashname == 'UMP|LR'] <- 'UMP' # Union for a Popular Movement / The Republicans
cabinets$v2pashname[cabinets$country_name == 'France' & cabinets$v2pashname == 'REM'] <- 'LaREM' # The Republic Onwards!

# Greece
cabinets$v2pashname[cabinets$country_name == 'Greece' & cabinets$v2pashname == 'LS-CA'] <- 'LS/CA' # Peoples Association -- Golden Dawn

# Hungary
cabinets$v2pashname[cabinets$country_name == 'Hungary' & cabinets$v2pashname == 'Fi-MPSz'] <- 'Fidesz' # Fidesz

# Ireland
cabinets$v2pashname[cabinets$country_name == 'Ireland' & cabinets$v2pashname == 'IA'] <- 'indep' # Independent Alliance
cabinets$v2pashname[cabinets$country_name == 'Ireland' & cabinets$v2pashname == 'SFWP'] <- 'WP' # Sinn Fein The Workers' Party

# Iceland
cabinets$v2pashname[cabinets$country_name == 'Iceland' & cabinets$v2pashname == 'Bf-87'] <- 'Bf' # 1987 party
cabinets$v2pashname[cabinets$country_name == 'Iceland' & cabinets$v2pashname == 'KL'] <- 'Sk' # Womens Alliance
cabinets$v2pashname[cabinets$country_name == 'Iceland' & cabinets$v2pashname == 'B-H'] <- 'B' # Citizens' Movement / Civic Movement -- The Movement
cabinets$v2pashname[cabinets$country_name == 'Iceland' & cabinets$v2pashname == 'M'] <- 'CP' # Centre Party

# Israel
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'MDL|HH'] <- 'Mafdal' # National Religious Party | The Jewish Home
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'Ma|Av'] <- 'A' # Alignment | Labor
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'TDL'] <- 'DASH' # Democratic Movement for Change
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'Shas'] <- 'SHAS' # Sephardi Guardians
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'YBA'] <- 'YB' # Israel for Immigration
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'MiHa'] <- 'MiHam / CP' # Centre Party
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'HaLe-T'] <- 'HH' # National Union--Tkuma
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'YA'] <- 'Yesh' # There is a Future
cabinets$v2pashname[cabinets$country_name == 'Israel' & cabinets$v2pashname == 'YaToMe'] <- 'YH' # United Torah Judaism

# Italy
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$party_name_short == 'FI-PdL' & cabinets$election_year <= 2007] <- 'FI' # Go Italy
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$party_name_short == 'FI-PdL' & cabinets$election_year >= 2008] <- 'IPdL' # People of Freedom
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$party_name_short == 'FI-PdL' & cabinets$election_year >= 2018] <- 'FI' # People of Freedom
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'DINI-RI'] <- 'RiI' # Italian Renewal
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'DS' & cabinets$election_year <= 1997] <- 'PDS' # Democratic Party of the Left (PDS) / Democrats of the Left
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'CCD+CDU'] <- 'CCD/CDU' # Christian Democratic Centre / United Christian
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'CeS'] <- 'Ulivo' # The Olive Tree / Centre Left
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'UC' & cabinets$election_year <= 2008] <- 'UDC' # Union / Centre
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'UC' & cabinets$election_year == 2013] <- 'UdC' # Union of the Centre - Union / Centre
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'R' & cabinets$election_year == 2006] <- 'RnP' # Rose in the Fist / Radicals
cabinets$v2pashname[cabinets$country_name == 'Italy' & cabinets$v2pashname == 'S' & cabinets$election_year == 2013] <- 'SEL' # Rose in the Fist / Italian Left (Sinistra Italiana, SI)

# Japan
cabinets$v2pashname[cabinets$country_name == 'Japan' & cabinets$v2pashname == 'JSP'] <- 'JSP/SDP' # Japan Socialist Party
cabinets$v2pashname[cabinets$country_name == 'Japan' & cabinets$v2pashname == 'TPJ'] <- 'PPLF' # Tomorrow Party of Japan / People First Party
cabinets$v2pashname[cabinets$country_name == 'Japan' & cabinets$v2pashname == 'CDP'] <- 'KDP' # Constitutional Democratic Party
# Latvia
cabinets$v2pashname[cabinets$country_name == 'Latvia' & cabinets$v2pashname == 'S'] <- 'SC' # Harmony
cabinets$v2pashname[cabinets$country_name == 'Latvia' & cabinets$v2pashname == 'PLL'] <- 'LPP/LC' # Latvian First Party / Latvian Way Party

# Lithuania
cabinets$v2pashname[cabinets$country_name == 'Lithuania' & cabinets$v2pashname == 'TS-LK'] <- 'TS-LKD' # Homeland Union
cabinets$v2pashname[cabinets$country_name == 'Lithuania' & cabinets$v2pashname == 'NS-SL'] <- 'NS' # New Union (Social Liberals)
cabinets$v2pashname[cabinets$country_name == 'Lithuania' & cabinets$v2pashname == 'LSDDP'] <- 'NS' # Social Democratic Labour Party of Lithuania
cabinets$v2pashname[cabinets$country_name == 'Lithuania' & cabinets$v2pashname == 'LSDP-89'] <- 'LSDP' # Lithuanian Social Democratic Party / 1989

# Luxembourg
cabinets$v2pashname[cabinets$country_name == 'Luxembourg' & cabinets$v2pashname == 'Greng'] <- 'Greng/GAP' # Greens
cabinets$v2pashname[cabinets$country_name == 'Luxembourg' & cabinets$v2pashname == 'AR|ADR'] <- 'AR/ADR' # Action Committee Pensions | Alternative Democratic Reform Party

# Latvia
cabinets$v2pashname[cabinets$country_name == 'Latvia' & cabinets$v2pashname == 'PS'] <- 'PS' # Civic Union - data missing
cabinets$v2pashname[cabinets$country_name == 'Latvia' & cabinets$v2pashname == 'RP' & cabinets$election_year <= 2012] <- 'ZRP' # Zatlers' Reform Party
cabinets$v2pashname[cabinets$country_name == 'Latvia' & cabinets$v2pashname == 'KPV-LV'] <- 'KPV LV' # Who owns the state
cabinets$v2pashname[cabinets$country_name == 'Latvia' & cabinets$v2pashname == 'LA' & cabinets$election_year == 2018] <- 'Development/...' # alliance: Development/For!

# Malta
cabinets$v2pashname[cabinets$country_name == 'Malta' & cabinets$v2pashname == 'PL'] <- 'MLP' # Malta Labour Party

# New Zealand
cabinets$v2pashname[cabinets$country_name == 'New Zealand' & cabinets$v2pashname == 'SC|DP'] <- 'SC/DP' # Social Credit | Democratic Party

# Norway
cabinets$v2pashname[cabinets$country_name == 'Norway' & cabinets$v2pashname == 'Sp'] <- 'Sp/Bp' # Centre [Agrarian] Party

# Poland
cabinets$v2pashname[cabinets$country_name == 'Poland' & cabinets$v2pashname == 'D|W|U'] <- 'UW-PD' # Freedom Union -- Democratic Party / Democratic | Freedom | Union
cabinets$v2pashname[cabinets$country_name == 'Poland' & cabinets$v2pashname == 'SLD' & cabinets$election_year == 2007] <- 'LiD' # SLD+SdPl+PD+UP – Lewica i Demokraci; SLD was largest party and vote-getter in coalition
cabinets$v2pashname[cabinets$country_name == 'Poland' & cabinets$v2pashname == 'WIO' & cabinets$election_year == 2019] <- 'Spr' # Spring party

# Portugal
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$v2pashname == 'PSD'] <- 'PPD/PSD' # Social Democratic Party
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$v2pashname == 'CDS-PP'] <- 'CDS / PP' # Democratic and Social Centre -- People's Party
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$v2pashname == 'PS' & cabinets$election_year == 1980] <- 'FRS' # Republican and Socialist Front (FRS); electoral alliance of the Socialist Party (PS), Leftwing Union for the Socialist Democracy (UEDS) and Independent Social Democratic Action (ASDI)
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$v2pashname == 'PCP' & cabinets$election_year >= 1987  ] <- 'CDU' # Portuguese Communist Party / CDU
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$v2pashname == 'PCP' & cabinets$election_year == 1979] <- 'APU' # APU electoral and political coalition between the Portuguese Communist Party (PCP) and the Portuguese Democratic Movement (MDP-CDE)
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$v2pashname == 'PCP' & cabinets$election_year == 1980] <- 'APU'
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$v2pashname == 'PCP' & cabinets$election_year == 1985] <- 'APU' 
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$party_name_short == 'PSD' & cabinets$election_year == 1979] <- 'AD' # Democratic Alliance 1979
cabinets$v2pashname[cabinets$country_name == 'Portugal' & cabinets$party_name_short == 'PSD' & cabinets$election_year == 1980] <- 'AD' # Democratic Alliance 1980

#Romania
cabinets$v2pashname[cabinets$country_name == 'Romania' & cabinets$v2pashname == 'PLR|ALDE'] <- 'ALDE' # Liberal Reformist Party | Alliance of Liberals
cabinets$v2pashname[cabinets$country_name == 'Romania' & cabinets$v2pashname == 'UDMR'] <- 'UDMR / DAHR /  RMDSZ' # Democratic Union of Hungarians
cabinets$v2pashname[cabinets$country_name == 'Romania' & cabinets$v2pashname == 'PU|PC'] <- 'PC / PUR' # Humanist Party | Conservative Party

#Slovakia
cabinets$v2pashname[cabinets$country_name == 'Slovakia' & cabinets$v2pashname == 'MK'] <- 'SMK-MKP' # Hungarian Coalition ## note 1994 is earliest year for SVK v-party data

#Slovenia
cabinets$v2pashname[cabinets$country_name == 'Slovenia' & cabinets$v2pashname == 'NSI'] <- 'NSi' # New Slovenia -- Christian People's Party
cabinets$v2pashname[cabinets$country_name == 'Slovenia' & cabinets$v2pashname == 'ZL-SD'] <- 'SD / ZLSD' # United List -- Social Democrats
cabinets$v2pashname[cabinets$country_name == 'Slovenia' & cabinets$v2pashname == 'LZJ-PS'] <- 'LZJPS' # Zoran Jankovic's List -- Positive Slovenia

# Sweden
cabinets$v2pashname[cabinets$country_name == 'Sweden' & cabinets$v2pashname == 'SAP'] <- 'S' # Social Democrats
cabinets$v2pashname[cabinets$country_name == 'Sweden' & cabinets$v2pashname == 'M'] <- 'H/M' # Right Party / Moderate Party
cabinets$v2pashname[cabinets$country_name == 'Sweden' & cabinets$v2pashname == 'C'] <- 'B/C' # Farmers' League / Centre Party
# Switzerland
cabinets$v2pashname[cabinets$country_name == 'Switzerland' & cabinets$v2pashname == 'LdU-ADI'] <- 'LdU' #Independents Alliance
cabinets$v2pashname[cabinets$country_name == 'Switzerland' & cabinets$v2pashname == 'FPS'] <- 'A/FPS' #Radical Dems
cabinets$v2pashname[cabinets$country_name == 'Switzerland' & cabinets$v2pashname == 'GPL-PVL'] <- 'GPL' #Green Liberal Party
# Turkey
cabinets$v2pashname[cabinets$country_name == 'Turkey' & cabinets$v2pashname == 'SHP|CHP' & cabinets$election_year <= 1991] <- 'SHP' # Social Democratic Populist Party
cabinets$v2pashname[cabinets$country_name == 'Turkey' & cabinets$v2pashname == 'SHP|CHP' & cabinets$election_year >= 1995] <- 'CHP' # Social Democratic Populist Party
cabinets$v2pashname[cabinets$country_name == 'Turkey' & cabinets$v2pashname == 'AKP' & cabinets$election_year == 2018] <- "People's All..." # People's Alliance (AKP)

####################################################
```






### Assign ideology scores to cabinet parties (ParlGov)

```{r match data}

# create country-year-party identifier (country+year+party)
cabinets$id <- paste(cabinets$country_name_short, cabinets$election_year, cabinets$v2pashname)

# create variable 
cabinets$antipluralism <- ''
# populate through match by 'id' variable
cabinets$antipluralism <- vparty$v2xpa_antiplural[match(cabinets$id, vparty$id)]
describe(cabinets$antipluralism[cabinets$election_year >= 1970 & cabinets$seat_share >= 0.05]) # 428 NA

# create variable 
cabinets$populism <- ''
# populate through match by 'id' variable
cabinets$populism <- vparty$v2xpa_popul[match(cabinets$id, vparty$id)]
describe(cabinets$populism[cabinets$election_year >= 1970 & cabinets$seat_share >= 0.05]) # 426 NA

#### Left right

# assess variable missing-ness
# Internal V-Party indicators
describe(vparty$v2xpa_popul) # Populism: 5590 missing, 6308 n
describe(vparty$v2pariglef) # Economic left-right scale: 5595 missing
#describe(vparty$ep_galtan_salience) # libertarian or traditional issues: 11769 missing
#describe(vparty$ep_v6_lib_cons) # Social Liberalism-Conservatism: 11376 missing

# create variable 
cabinets$conservativeness <- ''
# populate through match by 'id' variable
cabinets$conservativeness <- vparty$v2pariglef[match(cabinets$id, vparty$id)]
describe(cabinets$conservativeness[cabinets$election_year >= 1970 & cabinets$seat_share >= 0.05]) # 432 NA

##### Extremism

# create variable 
cabinets$extremism <- ''
# populate through match by 'id' variable
cabinets$extremism <- abs(vparty$v2pariglef[match(cabinets$id, vparty$id)])
describe(cabinets$extremism[cabinets$election_year >= 1970 & cabinets$seat_share >= 0.05]) # 432 NA

# States in parl gov data
unique(cabinets$country_name_short)
# create list
parl.states <- unique(cabinets$country_name_short)

# view distribution
hist(cabinets$antipluralism)
hist(cabinets$populism)
hist(cabinets$conservativeness)
hist(cabinets$extremism)

####################################################
```

### Parl gov api and popul

```{r parl gov api}

# coutry -cabint match id
cabinets$cc2 <- paste(cabinets$country_name, cabinets$cabinet_name)

# create gov party variable
cabinets$gov_party <- 0
cabinets$gov_party[cabinets$caretaker ==1  | cabinets$cabinet_party ==1 | cabinets$prime_minister ==1] <- 1

# create API_weight variable for aggregation;
cabinets$api_weight <- cabinets$antipluralism*cabinets$seat_share

# create popul_weight variable for aggregation;
cabinets$popul_weight <- cabinets$populism*cabinets$seat_share

# create conserv_weight variable for aggregation;
cabinets$conserv_weight <- cabinets$conservativeness*cabinets$seat_share

# create extremism_weight variable for aggregation;
cabinets$extremism_weight <- cabinets$extremism*cabinets$seat_share


# Export DataFrame to CSV file
write.csv(cabinets,file='~/Desktop/Phd Program/Fall 2024/Quantitative Model/cabinets_apr2025.csv')

############


### transform data, API

df1.cabinets <- aggregate(cabinets$api_weight, by=list(cabinets$country_name, cabinets$cabinet_name, cabinets$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

### transform data, API/cross check of above

#df1.cabinets.alt <- aggregate(cabinets$api_weight, by=list(cabinets$cc2, cabinets$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)
#df1.cabinets.alt.check <- as.data.frame(table(df1.cabinets.alt$Group.1))

# rename columns
names(df1.cabinets)[names(df1.cabinets) == 'Group.1'] <- 'country_name'
names(df1.cabinets)[names(df1.cabinets) == 'Group.2'] <- 'cabinet_name'
names(df1.cabinets)[names(df1.cabinets) == 'Group.3'] <- 'gov_parties'
names(df1.cabinets)[names(df1.cabinets) == 'x'] <- 'api_gov'

# describe
describe(df1.cabinets$api_gov)

# coutry -cabint match id
df1.cabinets$cc2 <- paste(df1.cabinets$country_name, df1.cabinets$cabinet_name)
df1.cabinets$cc3 <- paste(df1.cabinets$country_name, df1.cabinets$cabinet_name, df1.cabinets$gov_parties)

#########################################
### transform data, Populism
df2.cabinets <- aggregate(cabinets$popul_weight, by=list(cabinets$country_name, cabinets$cabinet_name, cabinets$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df2.cabinets)[names(df2.cabinets) == 'Group.1'] <- 'country_name'
names(df2.cabinets)[names(df2.cabinets) == 'Group.2'] <- 'cabinet_name'
names(df2.cabinets)[names(df2.cabinets) == 'Group.3'] <- 'gov_parties'
names(df2.cabinets)[names(df2.cabinets) == 'x'] <- 'popul_gov'

# describe
describe(df1.cabinets$api_gov)

# coutry -cabinet match id
df2.cabinets$cc2 <- paste(df2.cabinets$country_name, df2.cabinets$cabinet_name)
df2.cabinets$cc3 <- paste(df2.cabinets$country_name, df2.cabinets$cabinet_name, df2.cabinets$gov_parties)

#########################################
#### transform data, conservativeness
df2a.cabinets <- aggregate(cabinets$conserv_weight, by=list(cabinets$country_name, cabinets$cabinet_name, cabinets$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df2a.cabinets)[names(df2a.cabinets) == 'Group.1'] <- 'country_name'
names(df2a.cabinets)[names(df2a.cabinets) == 'Group.2'] <- 'cabinet_name'
names(df2a.cabinets)[names(df2a.cabinets) == 'Group.3'] <- 'gov_parties'
names(df2a.cabinets)[names(df2a.cabinets) == 'x'] <- 'conserv_gov'

# describe
describe(df2a.cabinets$conserv_gov)

# coutry -cabinet match id
df2a.cabinets$cc2 <- paste(df2a.cabinets$country_name, df2a.cabinets$cabinet_name)
df2a.cabinets$cc3 <- paste(df2a.cabinets$country_name, df2a.cabinets$cabinet_name, df2a.cabinets$gov_parties)

########################
#### transform data, conservativeness
df2b.cabinets <- aggregate(cabinets$extremism_weight, by=list(cabinets$country_name, cabinets$cabinet_name, cabinets$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df2b.cabinets)[names(df2b.cabinets) == 'Group.1'] <- 'country_name'
names(df2b.cabinets)[names(df2b.cabinets) == 'Group.2'] <- 'cabinet_name'
names(df2b.cabinets)[names(df2b.cabinets) == 'Group.3'] <- 'gov_parties'
names(df2b.cabinets)[names(df2b.cabinets) == 'x'] <- 'extremism_weight'

# describe
describe(df2b.cabinets$extremism_weight)

# coutry -cabinet match id
df2b.cabinets$cc2 <- paste(df2b.cabinets$country_name, df2b.cabinets$cabinet_name)
df2b.cabinets$cc3 <- paste(df2b.cabinets$country_name, df2b.cabinets$cabinet_name, df2b.cabinets$gov_parties)


### transform data, seat share
df3.cabinets <- aggregate(cabinets$seat_share, by=list(cabinets$country_name, cabinets$cabinet_name, cabinets$gov_party), FUN=sum, na.rm=TRUE, na.action=NULL)

# rename columns
names(df3.cabinets)[names(df3.cabinets) == 'Group.1'] <- 'country_name'
names(df3.cabinets)[names(df3.cabinets) == 'Group.2'] <- 'cabinet_name'
names(df3.cabinets)[names(df3.cabinets) == 'Group.3'] <- 'gov_parties'
names(df3.cabinets)[names(df3.cabinets) == 'x'] <- 'seat_share'

# describe
describe(df3.cabinets$seat_share)

# coutry -cabinet match id
df3.cabinets$cc2 <- paste(df3.cabinets$country_name, df3.cabinets$cabinet_name)
df3.cabinets$cc3 <- paste(df3.cabinets$country_name, df3.cabinets$cabinet_name, df3.cabinets$gov_parties)

df3.cabinets.check <- subset(df3.cabinets, seat_share <= .40 & gov_parties == 1)

```


```{r combine cabinets scores}
################# Populate
# popul_gov, from df2
df1.cabinets$popul_gov <- df2.cabinets$popul_gov[match(df1.cabinets$cc3, df2.cabinets$cc3)]
# conserv_gov, from df2a.cabinets
df1.cabinets$conserv_gov <- df2a.cabinets$conserv_gov[match(df1.cabinets$cc3, df2a.cabinets$cc3)]
# conserv_gov, from df2a.cabinets
df1.cabinets$extremism_gov <- df2b.cabinets$extremism_weight[match(df1.cabinets$cc3, df2b.cabinets$cc3)]
# seat_share, from df3.cabinets
df1.cabinets$seat_share_gov <- df3.cabinets$seat_share[match(df1.cabinets$cc3, df3.cabinets$cc3)]

################## year from cabinets
# country name short, cabinets
df1.cabinets$country_name_short <- cabinets$country_name_short[match(df1.cabinets$cc2, cabinets$cc2)]
# election year, cabinets
df1.cabinets$election_year <- cabinets$election_year[match(df1.cabinets$cc2, cabinets$cc2)]
# election year, cabinets
df1.cabinets$start_date <- cabinets$start_date[match(df1.cabinets$cc2, cabinets$cc2)]
# make start date a date
# format date for 2000-
df1.cabinets$start_date_fmt[df1.cabinets$election_year >= 2000] <- format(as.Date(df1.cabinets$start_date[df1.cabinets$election_year >= 2000], "%m/%d/%y"), "20%y-%m-%d")
# format date for -2000
df1.cabinets$start_date_fmt[df1.cabinets$election_year < 2000] <- format(as.Date(df1.cabinets$start_date[df1.cabinets$election_year < 2000], "%m/%d/%y"), "19%y-%m-%d")
# start year from start date
df1.cabinets$start_year <- format(as.Date(df1.cabinets$start_date_fmt, "%Y-%m-%d"),"%Y")
# Correct: format date for -2000 election but 2000- start date
df1.cabinets$start_date_fmt[df1.cabinets$election_year < 2000 & df1.cabinets$start_year < 1910] <- format(as.Date(df1.cabinets$start_date[df1.cabinets$election_year < 2000 & df1.cabinets$start_year < 1910], "%m/%d/%y"), "20%y-%m-%d")
# Correct: start year from start date
df1.cabinets$start_year <- format(as.Date(df1.cabinets$start_date_fmt, "%Y-%m-%d"),"%Y")

# create country-year identifier (country+year)
df1.cabinets$cy2 <- paste(df1.cabinets$country_name, df1.cabinets$election_year)
# create country-year identifier (country+year)
df1.cabinets$cy <- paste(df1.cabinets$country_name_short, df1.cabinets$election_year)
# create country-year identifier (country+year)
df1.cabinets$cs2 <- paste(df1.cabinets$country_name, df1.cabinets$start_year)

######### Create dataset for analysis

df.cabinets <- df1.cabinets

```

# Controls

## Democracy indicator

### Boix, Miller, Rosato 2013 - Regimes

```{r boix data}

## Load boix 2013 data 
boix2013 <- read.csv("~/Desktop/Phd Program/Fall 2024/Boix 2013 Dataverse/democracy-v4.0.csv")

# describe data
describe(boix2013$democracy) # 645 missing

# create fix variables
boix2013$country_fix <- boix2013$country
boix2013$abbreviation_fix <- boix2013$abbreviation

library(stringr)

# Fix country case (title case)
boix2013$country_fix <- str_to_title(boix2013$country_fix)

# fix country
boix2013$country_fix[boix2013$country == 'UNITED STATES OF AMERICA'] <- 'United States of America'
boix2013$country_fix[boix2013$country == 'CZECHOSLOVAKIA'] <- 'Czech Republic'
boix2013$country_fix[boix2013$country == 'TURKEY'] <- 'Turkey'



# fix abbreviations
boix2013$abbreviation_fix[boix2013$abbreviation == 'CSK'] <- 'CZE'
boix2013$abbreviation_fix[boix2013$abbreviation == 'SWD'] <- 'SWE'
boix2013$abbreviation_fix[boix2013$abbreviation == 'SVU'] <- 'RUS'
boix2013$abbreviation_fix[boix2013$abbreviation_undp == 'KSV'] <- 'XKX'
boix2013$abbreviation_fix[boix2013$abbreviation == 'ETF'] <- 'ETH'
boix2013$abbreviation_fix[boix2013$abbreviation == 'TMP'] <- 'TLS'
boix2013$abbreviation_fix[boix2013$abbreviation == 'ZAR'] <- 'COD'
boix2013$abbreviation_fix[boix2013$abbreviation_undp == 'MNT'] <- 'MNE'
boix2013$abbreviation_fix[boix2013$abbreviation_undp == 'SRB'] <- 'SRB'
boix2013$abbreviation_fix[boix2013$abbreviation == 'ROM'] <- 'ROU'


# create country-year identifier (country+year)
boix2013$cy <- paste(boix2013$abbreviation_fix, boix2013$year)
boix2013$cy2 <- paste(boix2013$country_fix, boix2013$year)

## Match data
# populate, match by country-year 'cy' variable
vparty$democracy <- boix2013$democracy[match(vparty$cy, boix2013$cy)] # 

## Match data
# populate, match by country-year 'cy' variable
#df.cabinets$democracy <- boix2013$democracy[match(df.cabinets$cy, boix2013$cy)] # 

```



## FDI Flow Data

### Load FDI Flow Data

```{r load fdi data}
### Load data -----------------------------------------

## Load fdi data (UN Stat), 1970-1989
fdi.inflow1989 <- read.csv("~/Desktop/PhD Program/Fall 2024/Quantitative Model/fdi_inflow_outflow_UNstat_1970-1989_inflow.csv") # FDI stock, current USD and accumulated flow, inflow
# Remove FDI Type column
fdi.inflow1989$Type <- NULL

## Load fdi data (UN Stat), 1990-2022
fdi.inflow2022 <- read.csv("~/Desktop/PhD Program/Fall 2024/Quantitative Model/US.FdiStock_1990-2022.csv")

#Combine datasets
fdi.inflow <- rbind(fdi.inflow1989, fdi.inflow2022)
# describe values
describe(fdi.inflow$Value) # mean=4117 US$M, Gmd=8105, 348 missing

# Create country_name variable to match V-Dem data
fdi.inflow$country_name <- fdi.inflow$Economy

# Fix data for "Switzerland", "Latvia", "Netherlands", "Turkey", [5] "Belgium", "Czech Republic", "Lithuania", "Luxembourg", "Slovenia"
# Note: Missing data for Latvia 1990-91, Lithuania 1990-91, Slovenia 1990-91, Switzerland pre-1983, Czech Republic 1990-92, Luxembourg pre-2002
fdi.inflow$country_name[fdi.inflow$Economy == 'Switzerland, Liechtenstein'] <- 'Switzerland' # V-Party does not include Liechtenstein
fdi.inflow$country_name[fdi.inflow$Economy == 'Netherlands (Kingdom of the)'] <- 'Netherlands'
fdi.inflow$country_name[fdi.inflow$Economy == 'Turkiye'] <- 'Turkey'
fdi.inflow$country_name[fdi.inflow$Economy == 'Czechia'] <- 'Czech Republic'
# Fix Belgium/Luxembourg, coded as one economy in 1970-1989 data
# Working solution: Subset the rbind to create identical entries for both
fdi.inflow.luxembourg <- subset(fdi.inflow, fdi.inflow$Economy == 'Belgium / Luxembourg')
# Change country name in both df.s
fdi.inflow.luxembourg$country_name[fdi.inflow.luxembourg$Economy == 'Belgium / Luxembourg'] <- 'Luxembourg'
fdi.inflow$country_name[fdi.inflow$Economy == 'Belgium / Luxembourg'] <- 'Belgium'
fdi.inflow <- rbind(fdi.inflow, fdi.inflow.luxembourg)

# create country-year identifier (country+year)
fdi.inflow$cy2 <- paste(fdi.inflow$country_name, fdi.inflow$Year)

# Match, include in model df
# populate FDI data to vparty df through match by country-year 'cy' variable
vparty$fdi_inflow <- fdi.inflow$Value[match(vparty$cy2, fdi.inflow$cy2)]
describe(vparty$fdi_inflow) # 2255 n, 61 missing (less than 3 percent missing)
unique(vparty$cy[is.na(vparty$fdi_inflow)]) # 402 country years

hist(vparty$year[is.na(vparty$fdi_inflow)])

# Unique countries in model data for which fdi data does not populate automatically
# unique(vparty.model$country_name[is.na(vparty.model$fdi_inflow)])
# Original missing: "Switzerland", "Latvia", "Netherlands", "Turkey", [5] "Belgium", "Czech Republic", "Lithuania", "Luxembourg", "Slovenia"
# vparty.model.fdi_check <- subset(vparty.model, is.na(vparty.model$fdi_inflow))

```


# Build V-Dem Dataframe for Main Model

### load V-Dem data

``` {r load vdem}
## Load vdem data 
load("~/Desktop/Phd Program/Fall 2024/ERT Data/v15 2025/vdem_v15.RData")

# Fix country names
vdem$country_name_fix <- vdem$country_name
vdem$country_name_fix[vdem$country_name == "Türkiye"] <- "Turkey"
 
# create country-year identifier (country+year)
vdem$cy <- paste(vdem$country_text_id, vdem$year)
vdem$cy2 <- paste(vdem$country_name_fix, vdem$year)



```



## Transform data

Transform data structure to be one observation per election, combining party API score by seat share.

Code references:
Combining: https://stackoverflow.com/questions/71526607/combining-multiple-rows-per-observation-into-one-in-r
Aggregate command: https://www.statology.org/aggregate-r/

```{r lag vdem}
# 3.8.1.4 Court packing (C) v2jupack
# 3.8.1.3 Government attacks on judiciary (C) (v2jupoatck)
# 3.8.1.2 Judicial purges (C) (v2jupurge)
# 3.8.1.10 Compliance with high court (C) (v2juhccomp)
# 2.2.10 Judicial constraints on the executive index (D) (v2x_jucon)

# Lag variable (2 years) using fixest package: https://lrberge.github.io/fixest/reference/lag.formula.html
#install.packages(fixest)
library(fixest)

# attack
vdem$v2jupoatck_lag2 <- lag_fml(v2jupoatck ~ country_name + year, k = -2, vdem)
vdem$v2jupoatck_lag1 <- lag_fml(v2jupoatck ~ country_name + year, k = -1, vdem)
vdem$v2jupoatck_lead1 <- lag_fml(v2jupoatck ~ country_name + year, k = 1, vdem)

# compliance
vdem$v2juhccomp_lag2 <- lag_fml(v2juhccomp ~ country_name + year, k = -2, vdem)
vdem$v2juhccomp_lag1 <- lag_fml(v2juhccomp ~ country_name + year, k = -1, vdem)
vdem$v2juhccomp_lead1 <- lag_fml(v2juhccomp ~ country_name + year, k = 1, vdem)

# purges
vdem$v2jupurge_lag2 <- lag_fml(v2jupurge ~ country_name + year, k = -2, vdem)
vdem$v2jupurge_lag1 <- lag_fml(v2jupurge ~ country_name + year, k = -1, vdem)
vdem$v2jupurge_lead1 <- lag_fml(v2jupurge ~ country_name + year, k = 1, vdem)

# packing
vdem$v2jupack_lag2 <- lag_fml(v2jupack ~ country_name + year, k = -2, vdem)
vdem$v2jupack_lag1 <- lag_fml(v2jupack ~ country_name + year, k = -1, vdem)
vdem$v2jupack_lead1 <- lag_fml(v2jupack ~ country_name + year, k = 1, vdem)

# constraints on exec
vdem$v2x_jucon_lag2 <- lag_fml(v2x_jucon ~ country_name + year, k = -2, vdem)
vdem$v2x_jucon_lag1 <- lag_fml(v2x_jucon ~ country_name + year, k = -1, vdem)
vdem$v2x_jucon_lead1 <- lag_fml(v2x_jucon ~ country_name + year, k = 1, vdem)

# hc independence
vdem$v2juhcind_lag2 <- lag_fml(v2juhcind ~ country_name + year, k = -2, vdem)
vdem$v2juhcind_lag1 <- lag_fml(v2juhcind ~ country_name + year, k = -1, vdem)
vdem$v2juhcind_lead1 <- lag_fml(v2juhcind ~ country_name + year, k = 1, vdem)

```

## Build dataframe

```{r replication dataframe}

df <- subset(vdem, select = c(cy, cy2, country_name, year, v2jupoatck_lag2, v2jupoatck_lag1, v2jupoatck, v2juhccomp_lag2, v2juhccomp_lag1, v2juhccomp, v2jupurge_lag2, v2jupurge_lag1, v2jupurge, v2jupack_lag2, v2jupack_lag1, v2jupack, v2x_jucon_lag2, v2x_jucon_lag1, v2x_jucon, v2juhcind_lag2, v2juhcind_lag1, v2juhcind, v2xlg_legcon, v2x_divparctrl, v2x_polyarchy, v2x_regime, e_gdppc, e_regiongeo, e_regionpol)) 

# 3.8.1.4 Court packing (C) v2jupack
# 3.8.1.3 Government attacks on judiciary (C) (v2jupoatck)
# 3.8.1.2 Judicial purges (C) (v2jupurge)
# 3.8.1.10 Compliance with high court (C) (v2juhccomp)

```

```{r populate country level data}
# V-dem
# create log of gdp/capita variable
df$log_e_gdppc <- log(df$e_gdppc)

# political region
## Transform political region variable

df$region[df$e_regionpol == 1] <- 'E. Europe'
df$region[df$e_regionpol == 2] <- 'Latin Am.'
df$region[df$e_regionpol == 3] <- 'MENA'
df$region[df$e_regionpol == 4] <- 'Sub-S. Africa'
df$region[df$e_regionpol == 5] <- 'W. Europe, N. Am.'
df$region[df$e_regionpol == 6] <- 'E. Asia'
df$region[df$e_regionpol == 7] <- 'S.E. Asia'
df$region[df$e_regionpol == 8] <- 'S. Asia'
df$region[df$e_regionpol == 9] <- 'Pacific'
df$region[df$e_regionpol == 10] <- 'Carribean'

# Henisz
# polcon with vdem
df$POLCONIII_VDEM <- polcon$POLCONIII_VDEM[match(df$cy2, polcon$cy2)]
# polcon
df$polconiii <- polcon$polconiii[match(df$cy2, polcon$cy2)]

# Linzer Staton
# LJI
df$LJI <- linzerstaton$LJI[match(df$cy2, linzerstaton$cy2)]
# LJI_lag
df$LJI_lag1 <- linzerstaton$LJI_lag1[match(df$cy2, linzerstaton$cy2)]
describe(df$LJI_lag1)
# LJI_lag
df$LJI_lag2 <- linzerstaton$LJI_lag2[match(df$cy2, linzerstaton$cy2)]
# LJI_lag
df$LJI_lag3 <- linzerstaton$LJI_lag3[match(df$cy2, linzerstaton$cy2)]
# LJI lead 1
df$LJI_lead1 <- linzerstaton$LJI_lead1[match(df$cy2, linzerstaton$cy2)]
# LJI lead 2
df$LJI_lead2 <- linzerstaton$LJI_lead2[match(df$cy2, linzerstaton$cy2)]

# Linzer Staton with vdem indicators
# LJI
df$LJI_vdem <- linzerstaton$LJI_vdem[match(df$cy2, linzerstaton$cy2)]
# LJI_lag
df$LJI_vdem_lag1 <- linzerstaton$LJI_vdem_lag1[match(df$cy2, linzerstaton$cy2)]
describe(df$LJI_vdem_lag1)
# LJI_vdem_lag
df$LJI_vdem_lag2 <- linzerstaton$LJI_vdem_lag2[match(df$cy2, linzerstaton$cy2)]
# LJI_vdem_lag
df$LJI_vdem_lag3 <- linzerstaton$LJI_vdem_lag3[match(df$cy2, linzerstaton$cy2)]
# LJI lead 1
df$LJI_vdem_lead1 <- linzerstaton$LJI_vdem_lead1[match(df$cy2, linzerstaton$cy2)]
# LJI lead 2
df$LJI_vdem_lead2 <- linzerstaton$LJI_vdem_lead2[match(df$cy2, linzerstaton$cy2)]


# ERT
# Regime transition
#df$reg_trans <- episodes$reg_trans[match(df$cy, episodes$cy)]
# Regime type
#df$reg_type <- episodes$reg_type[match(df$cy, episodes$cy)]
# Dem transition
#df$dem_transition <- episodes$dem_transition[match(df$cy, episodes$cy)]
#describe(df$dem_transition)
# Dem breakdown
#df$dem_breakdown <- episodes$dem_breakdown[match(df$cy, episodes$cy)]

## Boix, Miller, Rosato
# Democracy
df$boix_democracy <- boix2013$democracy[match(df$cy, boix2013$cy)]
describe(df$boix_democracy) # 17232 n, 10323 missing
# create democracy text variable
df$boix_democracy_text[df$boix_democracy == 1] <- 'democracy'
df$boix_democracy_text[df$boix_democracy == 0] <- 'autocracy'

# Democracy, omitted data (ex. occupation)
df$boix_democracy_omitteddata <- boix2013$democracy_omitteddata[match(df$cy, boix2013$cy)]
# Democracy transitions
df$boix_democracy_trans <- boix2013$democracy_trans[match(df$cy, boix2013$cy)]
# Democracy breakdowns
df$boix_democracy_breakdowns <- boix2013$democracy_breakdowns[match(df$cy, boix2013$cy)]
# Democracy breakdowns
df$boix_democracy_duration <- boix2013$democracy_duration[match(df$cy, boix2013$cy)]
# log of duration
df$boix_democracy_duration_log <- log(as.numeric(df$boix_democracy_duration))

# FDI
# FDI stock inflow
df$fdi_inflow <- fdi.inflow$Value[match(df$cy2, fdi.inflow$cy2)]
df$fdi_inflow_log <- log(df$fdi_inflow)

# DPI
# system (pres. parl.)
df$system <- DPI$system[match(df$cy, DPI$cy)] 
# system (pres. parl.)
df$checks <- DPI$checks[match(df$cy, DPI$cy)] 
# system (pres. parl.)
df$frac <- DPI$frac[match(df$cy, DPI$cy)] 
# Legislative variables
# govfrac
df$govfrac <- DPI$govfrac[match(df$cy, DPI$cy)] 
# NUMVOTE, Vote share of Government Parties
df$numvote <- DPI$numvote[match(df$cy, DPI$cy)] 
# LARGEST GOVT PARTY, GOV1ME Name
df$gov1me <- DPI$gov1me[match(df$cy, DPI$cy)] 
# GOV1VOTE Vote Share
df$gov1vote <- DPI$gov1vote[match(df$cy, DPI$cy)] 
# 2nd GOVT. PARTY, GOV2ME Name
df$gov2me <- DPI$gov2me[match(df$cy, DPI$cy)] 
# GOV2VOTE Vote Share
df$gov2vote <- DPI$gov2vote[match(df$cy, DPI$cy)] 
# 3rd GOVT. PARTY, GOV3ME Name
df$gov3me <- DPI$gov3me[match(df$cy, DPI$cy)] 
# GOV3VOTE Vote Share
df$gov3vote <- DPI$gov3vote[match(df$cy, DPI$cy)] 
# OPPFRAC, The probability that two deputies from among the opposition parties will be of different parties.
df$oppfrac <- DPI$oppfrac[match(df$cy, DPI$cy)] 
# OPPVOTE, Vote Share of Opposition Parties
df$oppvote <- DPI$oppvote[match(df$cy, DPI$cy)] 
# LARGEST OPP. PARTY, OPP1ME Name
df$opp1me <- DPI$opp1me[match(df$cy, DPI$cy)] 
# OPP1VOTE Vote Share
df$opp1vote <- DPI$opp1vote[match(df$cy, DPI$cy)] 
# 2nd OPP. PARTY, OPP2ME Name
df$opp2me <- DPI$opp2me[match(df$cy, DPI$cy)] 
# OPP2VOTE Vote Share
df$opp2vote <- DPI$opp2vote[match(df$cy, DPI$cy)] 
# 3rd OPP. PARTY, OPP3ME Name
df$opp3me <- DPI$opp3me[match(df$cy, DPI$cy)] 
# OPP3VOTE Vote Share
df$opp3vote <- DPI$opp3vote[match(df$cy, DPI$cy)] 

# Executive variables
# EXECME, Name of party executive
df$execme <- DPI$execme[match(df$cy, DPI$cy)] 
# PERCENTL, President got what % of votes in the final round?
df$percentl <- DPI$percentl[match(df$cy, DPI$cy)]
# EXECNAT, Nationalist (1 if yes) executive
df$execnat <- DPI$execnat[match(df$cy, DPI$cy)] 
#ALLHOUSE, Does party of executive control all relevant houses?
df$allhouse <- DPI$allhouse[match(df$cy, DPI$cy)] 

# V-Party combined
# api_gov, df.gov_scores
df$api_gov <- df.gov_scores$api_gov[match(df$cy2, df.gov_scores$cy2)]
# popul_gov, df.gov_scores
df$popul_gov <- df.gov_scores$popul_gov[match(df$cy2, df.gov_scores$cy2)]
# conserv_gov, df.gov_scores
df$conserv_gov <- df1$conserv_gov[match(df$cy2, df.gov_scores$cy2)]
# conserv_gov, df.gov_scores
df$extremism_gov <- df.gov_scores$extremism_gov[match(df$cy2, df.gov_scores$cy2)]
# seatshare_gov, df.gov_scores
df$seatshare_gov <- df.gov_scores$seatshare_gov[match(df$cy2, df.gov_scores$cy2)]
# seatshare_total, df1
df$seatshare_total <- df1$seatshare_total[match(df$cy2, df1$cy2)]
# api_gov, df1
df$api_exec_party <- df1$api_exec_party[match(df$cy2, df1$cy2)]
# popul_gov, df1
df$popul_exec_party <- df1$popul_exec_party[match(df$cy2, df1$cy2)]
# conserv_gov, df1
df$conserv_exec_party <- df1$conserv_exec_party[match(df$cy2, df1$cy2)]
# api_gov, df.opp_scores
df$api_opp <- df.opp_scores$api_gov[match(df$cy2, df.opp_scores$cy2)]
# popul_gov, df.opp_scores
df$popul_opp <- df.opp_scores$popul_gov[match(df$cy2, df.opp_scores$cy2)]
# conserv_gov, df.opp_scores
df$conserv_opp <- df.opp_scores$conserv_gov[match(df$cy2, df.opp_scores$cy2)]
# seatshare_gov, df.opp_scores
df$seatshare_opp <- df.opp_scores$seatshare_gov[match(df$cy2, df.opp_scores$cy2)]

```

```{r final df variables}

# high low edi for plots
df$edi_high[df$v2x_polyarchy >= 0.6] <- "high edi"
df$edi_high[df$v2x_polyarchy < 0.6] <- "low edi"

# regimes of the world
# VDem 5.1.1 Regimes of the world – the RoW measure (D) (v2x_regime)
# 0: Closed autocracy, 1: Electoral autocracy, 2: Electoral democracy, 3: Liberal democracy
df$regime_type <- NA
df$regime_type[df$v2x_regime == 0 | df$v2x_regime == 1] <- "Autocratic"
df$regime_type[df$v2x_regime == 2] <- "Electoral democracy"
df$regime_type[df$v2x_regime == 3] <- "Liberal democracy"

# pres_gov calculation
df$api_exec_gov <- NA
df$popul_exec_gov <- NA
df$conserv_exec_gov <- NA
# Take the average of presidential and cabinet ideological scores to produce a presidential government score (a.k.a weight both branches with 0.5).
df$api_exec_gov <- (df$api_exec_party+ df$api_gov)/2
df$popul_exec_gov <- (df$popul_exec_party + df$popul_gov)/2
df$conserv_exec_gov <- (df$conserv_exec_party + df$conserv_gov)/2


# model calculation
df$api_model <- NA
df$popul_model <- NA
df$conserv_model <- NA
# For presidential, use exec_gov
df$api_model[df$system == "Presidential" & !is.na(df$api_exec_gov)] <- df$api_exec_gov[df$system == "Presidential" & !is.na(df$api_exec_gov)]
df$popul_model[df$system == "Presidential" & !is.na(df$popul_exec_gov)] <- df$popul_exec_gov[df$system == "Presidential" & !is.na(df$popul_exec_gov)]
df$conserv_model[df$system == "Presidential" & !is.na(df$conserv_exec_gov)] <- df$conserv_exec_gov[df$system == "Presidential" & !is.na(df$conserv_exec_gov)]
# For presidential, use exec_gov
df$api_model[df$system != "Presidential" & !is.na(df$api_gov)] <- df$api_gov[df$system != "Presidential" & !is.na(df$api_gov)]
df$popul_model[df$system != "Presidential" & !is.na(df$popul_gov)] <- df$popul_gov[df$system != "Presidential" & !is.na(df$popul_gov)]
df$conserv_model[df$system != "Presidential" & !is.na(df$conserv_gov)] <- df$conserv_gov[df$system != "Presidential" & !is.na(df$conserv_gov)]

```

# Build Cabinets Dataframe for Main Model

```{r populate country level data cabinets}

## USE cy2 for COUNTRY YEAR of ELECTION
## USE cs2 for COUNTRY YEAR of START DATE

# V-dem
# edi variable
df.cabinets$v2x_polyarchy <- vdem$v2x_polyarchy[match(df.cabinets$cs2, vdem$cy2)]
# judicial constraints on executive variable
df.cabinets$v2x_jucon <- vdem$v2x_jucon[match(df.cabinets$cs2, vdem$cy2)]
# legislative constraints on executive variable
df.cabinets$v2xlg_legcon <- vdem$v2xlg_legcon[match(df.cabinets$cs2, vdem$cy2)]
# Divided party control index (D) (v2x_divparctrl)
df.cabinets$v2x_divparctrl <- vdem$v2x_divparctrl[match(df.cabinets$cs2, vdem$cy2)]
# Judicial attacks (Haggard and Tiede) v2jupack, v2jupurge, v2juhcind
df.cabinets$v2jupack <- vdem$v2jupack[match(df.cabinets$cs2, vdem$cy2)]
df.cabinets$v2jupurge <- vdem$v2jupurge[match(df.cabinets$cs2, vdem$cy2)]
df.cabinets$v2juhcind <- vdem$v2juhcind[match(df.cabinets$cs2, vdem$cy2)]
# gdp/capita variable
df.cabinets$e_gdppc <- vdem$e_gdppc[match(df.cabinets$cs2, vdem$cy2)]
##
# create log of gdp/capita variable
df.cabinets$log_e_gdppc <- log(df.cabinets$e_gdppc)

# Henisz
# polcon with vdem
df.cabinets$POLCONIII_VDEM <- polcon$POLCONIII_VDEM[match(df.cabinets$cs2, polcon$cy2)]
# polcon
df.cabinets$polconiii <- polcon$polconiii[match(df.cabinets$cs2, polcon$cy2)]

# Linzer Staton
# LJI
df.cabinets$LJI <- linzerstaton$LJI[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI_lag
df.cabinets$LJI_lag1 <- linzerstaton$LJI_lag1[match(df.cabinets$cs2, linzerstaton$cy2)]
#describe(df.cabinets$LJI_lag1)
# LJI_lag
df.cabinets$LJI_lag2 <- linzerstaton$LJI_lag2[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI_lag
df.cabinets$LJI_lag3 <- linzerstaton$LJI_lag3[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI lead 1
df.cabinets$LJI_lead1 <- linzerstaton$LJI_lead1[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI lead 2
df.cabinets$LJI_lead2 <- linzerstaton$LJI_lead2[match(df.cabinets$cs2, linzerstaton$cy2)]

# Linzer Staton with vdem indicators
# LJI
df.cabinets$LJI_vdem <- linzerstaton$LJI_vdem[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI_lag
df.cabinets$LJI_vdem_lag1 <- linzerstaton$LJI_vdem_lag1[match(df.cabinets$cs2, linzerstaton$cy2)]
#describe(df.cabinets$LJI_vdem_lag1)
# LJI_vdem_lag
df.cabinets$LJI_vdem_lag2 <- linzerstaton$LJI_vdem_lag2[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI_vdem_lag
df.cabinets$LJI_vdem_lag3 <- linzerstaton$LJI_vdem_lag3[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI lead 1
df.cabinets$LJI_vdem_lead1 <- linzerstaton$LJI_vdem_lead1[match(df.cabinets$cs2, linzerstaton$cy2)]
# LJI lead 2
df.cabinets$LJI_vdem_lead2 <- linzerstaton$LJI_vdem_lead2[match(df.cabinets$cs2, linzerstaton$cy2)]

# ERT
# Regime transition
#df.cabinets$reg_trans <- episodes$reg_trans[match(df.cabinets$cy, episodes$cy)]
# Regime type
#df.cabinets$reg_type <- episodes$reg_type[match(df.cabinets$cy, episodes$cy)]
# Dem transition
#df.cabinets$dem_transition <- episodes$dem_transition[match(df.cabinets$cy, episodes$cy)]
#describe(df.cabinets$dem_transition)
# Dem breakdown
#df.cabinets$dem_breakdown <- episodes$dem_breakdown[match(df.cabinets$cy, episodes$cy)]

## Boix, Miller, Rosato
# Democracy
df.cabinets$boix_democracy <- boix2013$democracy[match(df.cabinets$cy, boix2013$cy)]
#describe(df.cabinets$boix_democracy) # 
# create democracy text variable
df.cabinets$boix_democracy_text[df.cabinets$boix_democracy == 1] <- 'democracy'
df.cabinets$boix_democracy_text[df.cabinets$boix_democracy == 0] <- 'autocracy'

# Democracy, omitted data (ex. occupation)
df.cabinets$boix_democracy_omitteddata <- boix2013$democracy_omitteddata[match(df.cabinets$cy, boix2013$cy)]
# Democracy transitions
df.cabinets$boix_democracy_trans <- boix2013$democracy_trans[match(df.cabinets$cy, boix2013$cy)]
# Democracy breakdowns
df.cabinets$boix_democracy_breakdowns <- boix2013$democracy_breakdowns[match(df.cabinets$cy, boix2013$cy)]
# Democracy breakdowns
df.cabinets$boix_democracy_duration <- boix2013$democracy_duration[match(df.cabinets$cy, boix2013$cy)]
# log of duration
df.cabinets$boix_democracy_duration_log <- log(as.numeric(df.cabinets$boix_democracy_duration))

# FDI
# FDI stock inflow
df.cabinets$fdi_inflow <- fdi.inflow$Value[match(df.cabinets$cs2, fdi.inflow$cy2)]
df.cabinets$fdi_inflow_log <- log(df.cabinets$fdi_inflow)

# DPI
# system (pres. parl.)
df.cabinets$system <- DPI$system[match(df.cabinets$cy, DPI$cy)] 
# Legislative variables
# govfrac
df.cabinets$govfrac <- DPI$govfrac[match(df.cabinets$cy, DPI$cy)] 
# NUMVOTE, Vote share of Government Parties
df.cabinets$numvote <- DPI$numvote[match(df.cabinets$cy, DPI$cy)] 
# LARGEST GOVT PARTY, GOV1ME Name
df.cabinets$gov1me <- DPI$gov1me[match(df.cabinets$cy, DPI$cy)] 
# GOV1VOTE Vote Share
df.cabinets$gov1vote <- DPI$gov1vote[match(df.cabinets$cy, DPI$cy)] 
# 2nd GOVT. PARTY, GOV2ME Name
df.cabinets$gov2me <- DPI$gov2me[match(df.cabinets$cy, DPI$cy)] 
# GOV2VOTE Vote Share
df.cabinets$gov2vote <- DPI$gov2vote[match(df.cabinets$cy, DPI$cy)] 
# 3rd GOVT. PARTY, GOV3ME Name
df.cabinets$gov3me <- DPI$gov3me[match(df.cabinets$cy, DPI$cy)] 
# GOV3VOTE Vote Share
df.cabinets$gov3vote <- DPI$gov3vote[match(df.cabinets$cy, DPI$cy)] 
# OPPFRAC, The probability that two deputies from among the opposition parties will be of different parties.
df.cabinets$oppfrac <- DPI$oppfrac[match(df.cabinets$cy, DPI$cy)] 
# OPPVOTE, Vote Share of Opposition Parties
df.cabinets$oppvote <- DPI$oppvote[match(df.cabinets$cy, DPI$cy)] 
# LARGEST OPP. PARTY, OPP1ME Name
df.cabinets$opp1me <- DPI$opp1me[match(df.cabinets$cy, DPI$cy)] 
# OPP1VOTE Vote Share
df.cabinets$opp1vote <- DPI$opp1vote[match(df.cabinets$cy, DPI$cy)] 
# 2nd OPP. PARTY, OPP2ME Name
df.cabinets$opp2me <- DPI$opp2me[match(df.cabinets$cy, DPI$cy)] 
# OPP2VOTE Vote Share
df.cabinets$opp2vote <- DPI$opp2vote[match(df.cabinets$cy, DPI$cy)] 
# 3rd OPP. PARTY, OPP3ME Name
df.cabinets$opp3me <- DPI$opp3me[match(df.cabinets$cy, DPI$cy)] 
# OPP3VOTE Vote Share
df.cabinets$opp3vote <- DPI$opp3vote[match(df.cabinets$cy, DPI$cy)] 
# Executive variables
# EXECME, Name of party executive
df.cabinets$execme <- DPI$execme[match(df.cabinets$cy, DPI$cy)] 
# PERCENTL, President got what % of votes in the final round?
df.cabinets$percentl <- DPI$percentl[match(df.cabinets$cy, DPI$cy)]
# EXECNAT, Nationalist (1 if yes) executive
df.cabinets$execnat <- DPI$execnat[match(df.cabinets$cy, DPI$cy)] 
#ALLHOUSE, Does party of executive control all relevant houses?
df.cabinets$allhouse <- DPI$allhouse[match(df.cabinets$cy, DPI$cy)] 

# V-Party combined
# api_gov, df1
#df.cabinets$api_gov <- df1$api_gov[match(df.cabinets$cs2, df1$cy2)]
# popul_gov, df1
#df.cabinets$popul_gov <- df1$popul_gov[match(df.cabinets$cs2, df1$cy2)]
# conserv_gov, df1
#df.cabinets$conserv_gov <- df1$conserv_gov[match(df.cabinets$cs2, df1$cy2)]
# conserv_gov, df1
#df.cabinets$extremism_gov <- df1$extremism_gov[match(df$cy2, df1$cy2)]
# seatshare_gov, df1
#df$seatshare_gov <- df1$seatshare_gov[match(df$cy2, df1$cy2)]

```

```{r check merge}

## Boix, Miller, Rosato
# Democracy
vparty$boix_democracy <- boix2013$democracy[match(vparty$cy, boix2013$cy)]

# check merge
vparty.dpi.check <- subset(vparty, year >= 1975 & year <= 2020 & is.na(system) & boix_democracy == 1)
unique(vparty.dpi.check$country_name)

vparty.dpi.check.gov <- subset(vparty, year >= 1975 & year <= 2020 & is.na(gov_party) & v2paseatshare >= 5.0 & !(country_name %in% c("Kosovo","Palestine/West Bank","Somaliland","Hong Kong","Montenegro","Sao Tome and Principe","Serbia","Seychelles","Zanzibar")) & boix_democracy == 1)
unique(vparty.dpi.check.gov$country_name)

# dataset unique parties
vparty.dpi.valid <- subset(vparty, year >= 1976 & year <= 2015 & (!is.na(system)) & boix_democracy == 1 & (!is.na(v2xpa_antiplural)))
describe(unique(vparty.dpi.valid$v2paenname))

```

# Export data

```{r export data}

#vdem_states <- unique(vdem$country_name)
#vdem_states

# Export DataFrame as CSV file
write.csv(df,file='~/Desktop/Phd Program/Fall 2024/Spring 2025/Quant Model Submission/ideology_independence_data_7_24.csv')


# Export DataFrame as RData file
save(df, cabinets, df.cabinets, df.gov_scores, df.opp_scores, boix2013, fdi.inflow, linzerstaton, polcon, vparty, DPI, file='~/Desktop/Phd Program/Fall 2024/Spring 2025/Quant Model Submission/ideology_independence_data.RData')


```

